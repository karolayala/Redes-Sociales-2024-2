<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Karol Ayala">

<title>Taller 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/d3-4.5.0/d3.min.js"></script>

<script src="site_libs/forceNetwork-binding-0.4/forceNetwork.js"></script>

<link href="site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">

<script src="site_libs/vis-9.1.0/vis-network.min.js"></script>

<script src="site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Redes Sociales - Karol Stefanny Ayala LÃ³pez</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Taller1.html">Talleres</a></li><li class="breadcrumb-item"><a href="./Taller2.html">Taller 2</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Talleres</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taller 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Taller2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Taller 2</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#punto-1" id="toc-punto-1" class="nav-link active" data-scroll-target="#punto-1">Punto 1</a></li>
  <li><a href="#punto-2" id="toc-punto-2" class="nav-link" data-scroll-target="#punto-2">Punto 2</a></li>
  <li><a href="#punto-3" id="toc-punto-3" class="nav-link" data-scroll-target="#punto-3">Punto 3</a></li>
  <li><a href="#punto-4" id="toc-punto-4" class="nav-link" data-scroll-target="#punto-4">Punto 4</a></li>
  <li><a href="#punto-5" id="toc-punto-5" class="nav-link" data-scroll-target="#punto-5">Punto 5</a></li>
  <li><a href="#punto-6" id="toc-punto-6" class="nav-link" data-scroll-target="#punto-6">Punto 6</a></li>
  <li><a href="#punto-7" id="toc-punto-7" class="nav-link" data-scroll-target="#punto-7">Punto 7</a></li>
  <li><a href="#punto-8" id="toc-punto-8" class="nav-link" data-scroll-target="#punto-8">Punto 8</a></li>
  <li><a href="#punto-9" id="toc-punto-9" class="nav-link" data-scroll-target="#punto-9">Punto 9</a>
  <ul class="collapse">
  <li><a href="#capÃ­tulo-6---graficos-avanzados-de-redes" id="toc-capÃ­tulo-6---graficos-avanzados-de-redes" class="nav-link" data-scroll-target="#capÃ­tulo-6---graficos-avanzados-de-redes">CapÃ­tulo 6 - Graficos avanzados de redes</a></li>
  <li><a href="#capÃ­tulo-8---subgrupos" id="toc-capÃ­tulo-8---subgrupos" class="nav-link" data-scroll-target="#capÃ­tulo-8---subgrupos">CapÃ­tulo 8 - Subgrupos</a></li>
  <li><a href="#capÃ­tulo-9---redes-de-afiliaciÃ³n" id="toc-capÃ­tulo-9---redes-de-afiliaciÃ³n" class="nav-link" data-scroll-target="#capÃ­tulo-9---redes-de-afiliaciÃ³n">CapÃ­tulo 9 - Redes de afiliaciÃ³n</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Taller1.html">Talleres</a></li><li class="breadcrumb-item"><a href="./Taller2.html">Taller 2</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Taller 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Karol Ayala </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="punto-1" class="level2">
<h2 class="anchored" data-anchor-id="punto-1">Punto 1</h2>
<p>El grado de un nodo en una red tanto dirigida como no dirigida se puede calcular fÃ¡cilmente a partir de la matriz de adyacencia <span class="math inline">\(\mathbf{Y}=[y_{i,j}]\)</span>. El <em>out-degree</em> <span class="math inline">\(d_i^{\text{out}}\)</span> y el <em>in-degree</em> <span class="math inline">\(d_i^{\text{in}}\)</span> del nodo <span class="math inline">\(i\)</span> se pueden calcular respectivamente como: <span class="math display">\[
d_i^{\text{out}} = \sum_{j:j\neq i} y_{i,j}
\qquad\text{y}\qquad
d_i^{\text{in}} = \sum_{j:j\neq i} y_{j,i}
\]</span> <strong>Muestre que si la red es no dirigida entonces</strong> <span class="math inline">\(d_i^{\text{out}} = d_i^{\text{in}}\)</span>.</p>
<p>Si la red no es dirigida, <span class="math inline">\(Y = [y_{ij}]\)</span> es simÃ©trica, asÃ­ <span class="math inline">\(Y = [y_{ij}] = [y_{ji}] = Y^T\)</span>, entonces:</p>
<p><span class="math display">\[
d_i^{\text{out}} = \sum_{j:j \neq i} y_{i,j}= \sum_{j:j \neq i} y_{j,i}  = d_i^{\text{in}}
\]</span></p>
</section>
<section id="punto-2" class="level2">
<h2 class="anchored" data-anchor-id="punto-2">Punto 2</h2>
<p>Tanto para redes dirigidas como no dirigidas, se define la media global de las interacciones como <span class="math display">\[
\bar{y}=\frac{1}{n(n-1)}\sum_{i,j:i\neq j} y_{i,j}
\]</span> donde <span class="math inline">\(\mathbf{Y}=[y_{i,j}]\)</span> es la matriz de adyacencia de la red correspondiente. Tal estadÃ­stico corresponde a una descripciÃ³n muy rudimentaria acerca de la plausibilidad de observar una relaciÃ³n entre dos nodos cualesquiera, dado que no tiene en cuenta la heterogeneidad nodal (algunos nodos son mÃ¡s propensos a enviar/recibir mÃ¡s relaciones).</p>
<p><strong>a. Muestre que para relaciones no dirigidas la media global</strong> <span class="math inline">\(\bar{y}\)</span> <strong>es igual a la media tanto de la parte triangular superior de</strong> <span class="math inline">\(\mathbf{Y}\)</span> <strong>como de la parte triangular inferior de</strong> <span class="math inline">\(\mathbf{Y}\)</span>.</p>
<p>Como la red es no dirigida, <span class="math inline">\(Y = [y_{i,j}] = [y_{j,i}] = Y^T\)</span>, por lo tanto: <span class="math display">\[\sum_{i,j: i &gt; j} y_{i,j} = \sum_{i,j: i &lt; j} y_{i,j}\]</span> AsÃ­: <span class="math display">\[
\bar{y}_{\text{sup}} =  \frac{2}{n(n-1)} \sum_{i,j: i &gt; j} y_{i,j} = \frac{2}{n(n-1)} \sum_{i,j: i &lt; j} y_{i,j} = \bar{y}_{\text{inf}}
\]</span></p>
<p>Por otro lado, <span class="math display">\[\sum_{i,j: j \neq i} y_{ij}\]</span> es una suma de 0âs y 1âs sobre toda la matriz <span class="math inline">\(Y\)</span>, entonces <span class="math display">\[
\frac{1}{2} \sum_{i,j: i \neq j} y_{i,j} =  \sum_{i,j: i &lt; j} y_{i,j} = \sum_{i,j: i &gt; j} y_{j,i}
\]</span> Luego,</p>
<p><span class="math display">\[
\bar{y}=\frac{1}{n(n-1)}\sum_{i,j:i\neq j} y_{i,j} = \frac{2}{n(n-1)} \sum_{i,j: i &gt; j} y_{i,j} = \frac{2}{n(n-1)} \sum_{i,j: i &lt;j} y_{i,j}
\]</span></p>
<p><strong>b. Muestre que tanto para relaciones dirigidas como no dirigidas la media global corresponde a la densidad de la red.</strong></p>
<p><strong>Redes no dirigidas</strong></p>
<p>Para un subgrafo <em>H</em>, la densidad se define como <span class="math display">\[
\text{den}(H) = \frac{|E_H|}{|V_H|(|V_H|-1)/2}
\]</span> En una red no dirigida, la cantidad de aristas se puede calcular como la suma de la matriz triangular superior o inferior de la matriz de adyacencia <em>Y</em>: <span class="math display">\[
|E_H| = \sum_{i,j: i&gt;j} y_{i,j}
\]</span> Por otro lado, <span class="math inline">\(|V_H|\)</span> corresponde a la cantidad de vÃ©rtices del grafo, que es igual al nÃºmero de filas (n) o columnas (n) de la matriz de adyacencia.</p>
<p><span class="math display">\[
\text{den}(H)  = \frac{2|E_H|}{|V_H|(|V_H|-1)} = \frac{2}{n(n-1)} \sum_{i,j:i&lt;j} y_{i,j}
\]</span> Que, por el resultado anterior, es igual a: <span class="math display">\[
\bar{y}=\frac{1}{n(n-1)}\sum_{i,j:i\neq j} y_{i,j}
\]</span> <strong>Redes dirigidas</strong></p>
<p>En una red no dirigida, la cantidad de aristas se puede calcular como la suma de la matriz de adyacencia <em>Y</em>: <span class="math display">\[
\sum_{i,j:i \neq j} y_{ij}
\]</span> y <span class="math inline">\(|V_H|=n\)</span> como en el caso de una red no dirigida.</p>
<p>AsÃ­: <span class="math display">\[
\text{den}(H)  = \frac{|E_H|}{|V_H|(|V_H|-1)} = \frac{1}{n(n-1)} \sum_{i,j:i \neq j} y_{i,j} = \bar{y}
\]</span></p>
<p><strong>c.&nbsp;Muestre que tanto para relaciones dirigidas como no dirigidas se tiene que</strong> <span class="math inline">\((n-1)\bar{y} = \bar{d}^{\text{out}}=\bar{d}^{\text{in}}\)</span>. <strong>Es decir, el grado promedio tanto de entrada como de salida son iguales y a su vez equivalentes la densidad.</strong></p>
<p><strong>Redes no dirigidas</strong> <span class="math display">\[
(n-1)  \bar{y} = (n-1)  \frac{1}{n(n-1)} \sum_{i,j: i \neq j} y_{i,j} = \frac{1}{n} \sum_{i,j: i \neq j} y_{i,j}
\]</span> <span class="math display">\[
= \frac{1}{n} \sum_{i=1}^n \sum_{j=j \neq i} y_{i,j} = \frac{1}{n} \sum_{i=1}^n d_i^{\text{out}} = \bar{d}^{\text{out}}
\]</span> segÃºn el resultado del punto 1, en una red no dirigida <span class="math inline">\(d^{in} = d^{out}\)</span>, luego <span class="math display">\[
\frac{1}{n} \sum_{i=1}^n d_i^{\text{out}} = \frac{1}{n} \sum_{i=1}^n d_i^{\text{in}}
\]</span> <span class="math display">\[
\bar{d}^{\text{in}} = \bar{d}^{\text{out}}
\]</span> <strong>Redes dirigidas</strong></p>
<p><span class="math display">\[
d_i^{\text{in}} = \sum_{j: j \neq i} y_{j,i}
\]</span></p>
<p><span class="math display">\[
\bar{d}^{\text{in}} =  \frac{1}{n} \sum_{i=1}^n \sum_{j=j \neq i} y_{j, i} =  \frac{1}{n} \sum_{i=1}^n \sum_{j=j \neq i} y_{i, j} = \bar{d}^{\text{out}}
\]</span> <span class="math inline">\(\bar{d}^{\text{in}}\)</span> se puede entender como una suma por columnas de la matriz de adyacencia sobre <span class="math inline">\(n\)</span> y <span class="math inline">\(\bar{d}^{\text{out}}\)</span> como una suma por filas de la matriz de adyacencia sobre <span class="math inline">\(n\)</span>.</p>
<p>Por otro lado, <span class="math display">\[
(n-1)  \bar{y} = (n-1)  \frac{1}{n(n-1)} \sum_{i,j: i \neq j} y_{i,j} = \frac{1}{n} \sum_{i,j: i \neq j} y_{i,j}
\]</span> <span class="math display">\[
= \frac{1}{n} \sum_{i=1}^n \sum_{j=j \neq i} y_{i,j} = \frac{1}{n} \sum_{i=1}^n d_i^{\text{out}} = \bar{d}^{\text{out}}  = \bar{d}^{\text{in}}
\]</span></p>
</section>
<section id="punto-3" class="level2">
<h2 class="anchored" data-anchor-id="punto-3">Punto 3</h2>
<p>Considere un grafo estrella de orden <span class="math inline">\(n\)</span> y un grafo cÃ­rculo de orden <span class="math inline">\(n\)</span>. A continuaciÃ³n se representan ambos grafos para <span class="math inline">\(n=9\)</span>. Estos grafos tienen aproximadamente la misma densidad, pero su estructura es muy diferente. Recuerde que la densidad de un grafo se puede calcular como el grado promedio dividido por <span class="math inline">\(n - 1\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="star_circle.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
<p><strong>a. Muestre que para el grafo cÃ­rculo de orden</strong> <span class="math inline">\(n\)</span> <strong>el grado promedio es</strong> <span class="math inline">\(\bar{d} = 2\)</span>.</p>
<p>La matriz de adyacencia para un grafo cÃ­rculo de orden n, serÃ­a: <span class="math display">\[
Y_{n*n} =
\begin{bmatrix}
. &amp; 1 &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 \\
1 &amp; . &amp; 1 &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . \\
. &amp; 1 &amp; . &amp; 1 &amp; . &amp; . &amp; . &amp; . &amp; . \\
. &amp; . &amp; 1 &amp; . &amp; 1 &amp; . &amp; . &amp; . &amp; . \\
. &amp; . &amp; . &amp; 1 &amp; . &amp; 1 &amp; . &amp; . &amp; . \\
. &amp; . &amp; . &amp; . &amp; 1 &amp; . &amp; 1 &amp; . &amp; . \\
. &amp; . &amp; . &amp; . &amp; . &amp; 1 &amp; . &amp; 1 &amp; . \\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 &amp; . &amp; 1 \\
1 &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 &amp; . \\
\end{bmatrix}
\]</span> En un grafo cÃ­rculo, cada vÃ©rtice tiene un grado de <span class="math inline">\(2\)</span>. Luego, la suma de todos los grados es: <span class="math display">\[
\sum_{i,j=i \neq j} y_{i,j} = 2n
\]</span> El grado promedio es: <span class="math display">\[
\bar{d} = (n-1) \bar{y} =  (n-1)  \frac{1}{n(n-1)} \sum_{i,j: i \neq j} y_{i,j} = \frac{1}{n} 2n = 2
\]</span></p>
<p><strong>b. Muestre que para el grafo estrella de orden <span class="math inline">\(n\)</span> el grado promedio es</strong> <span class="math inline">\(\bar{d} = 2\frac{n-1}{n} \rightarrow 2\)</span> <strong>cuando</strong> <span class="math inline">\(n\rightarrow\infty\)</span>.</p>
<p>La matriz de adyacencia para un grafo estrella de orden n, serÃ­a: <span class="math display">\[
Y_{n*n} =
\begin{bmatrix}
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 \\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 \\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 \\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 \\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 \\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 \\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 \\
. &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; . &amp; 1 \\
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; . \\
\end{bmatrix}
\]</span> En un grafo estrella, cada vÃ©rtice tiene una relaciÃ³n con el vÃ©rtice central <span class="math inline">\(n\)</span>, con excepciÃ³n del vÃ©rtice central que tiene <span class="math inline">\(n-1\)</span> relaciones. Esto implica: <span class="math display">\[
|E| = (n-1) + (n-1) = 2n-2 = 2(n-1) = \sum_{i,j: i \neq j} y_{i,j}
\]</span> AsÃ­, el grado promedio es: <span class="math display">\[
\bar{d} = (n-1) \bar{y} =  (n-1)  \frac{1}{n(n-1)} \sum_{i,j: i \neq j} y_{i,j} = \frac{2(n-1)}{n}
\]</span> Cuando <span class="math inline">\({n \to \infty}\)</span>,</p>
<p><span class="math display">\[\bar{d} = 2\frac{n-1}{n} = 2 \frac{n}{n} \frac{1}{n} = 2 \frac{1}{n} \rightarrow 2\]</span></p>
</section>
<section id="punto-4" class="level2">
<h2 class="anchored" data-anchor-id="punto-4">Punto 4</h2>
<p>Â¿CuÃ¡les de las siguientes secuencias son caminatas en el grafo que se presenta a continuaciÃ³n? Â¿CuÃ¡les senderos? Â¿CuÃ¡les circuitos? Â¿CuÃ¡les ciclos?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="wtp.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:25.0%" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
<p><strong>a.</strong> <span class="math inline">\(2 - 1 - 6 - 3 - 4\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">graph_from_literal</span>(<span class="dv">1-2</span>,<span class="dv">1-5</span>,<span class="dv">6-1</span>,<span class="dv">4-1</span>,<span class="dv">2-5</span>,<span class="dv">3-4</span>,<span class="dv">3-6</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Secuencia 2â1â6â3â4</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>V_cam1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>E_cam1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-2"</span>, <span class="st">"1-6"</span>, <span class="st">"3-6"</span>, <span class="st">"3-4"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g4)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g4)<span class="sc">$</span>name <span class="sc">%in%</span> V_cam1, <span class="st">"red"</span>, <span class="st">"white"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g4)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">apply</span>(<span class="fu">ends</span>(g4, <span class="fu">E</span>(g4)), <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">sort</span>(x), <span class="at">collapse=</span><span class="st">"-"</span>)) <span class="sc">%in%</span> E_cam1, <span class="st">"red"</span>, <span class="st">"gray"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3312</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g4, <span class="at">edge.arrow.size=</span><span class="dv">1</span>, <span class="at">vertex.size=</span><span class="dv">20</span>, <span class="at">vertex.label.cex=</span><span class="dv">1</span>, <span class="at">main=</span><span class="st">"Secuencia 2â1â6â3â4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Esta secuencia es un sendero, ya que es una caminata abierta que no tiene vertices ni aristas repetidas.</p>
<p><strong>b.</strong> <span class="math inline">\(2 - 1 - 6 - 3 - 4 - 1 - 5\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Secuencia 2 - 1 - 6 - 3 - 4 - 1 - 5</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>V_cam2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>E_cam2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-2"</span>, <span class="st">"1-6"</span>, <span class="st">"1-4"</span>, <span class="st">"1-5"</span>, <span class="st">"3-6"</span>, <span class="st">"3-4"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g4)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g4)<span class="sc">$</span>name <span class="sc">%in%</span> V_cam2, <span class="st">"red"</span>, <span class="st">"white"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g4)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">apply</span>(<span class="fu">ends</span>(g4, <span class="fu">E</span>(g4)), <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">sort</span>(x), <span class="at">collapse=</span><span class="st">"-"</span>)) <span class="sc">%in%</span> E_cam2, <span class="st">"red"</span>, <span class="st">"gray"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3312</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g4, <span class="at">edge.arrow.size=</span><span class="dv">1</span>, <span class="at">vertex.size=</span><span class="dv">20</span>, <span class="at">vertex.label.cex=</span><span class="dv">1</span>, <span class="at">main=</span><span class="st">"Secuencia 2-1-6-3-4-1-5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Esta secuencia es un sendero, ya que es una caminata abierta que tiene vertices repetidos, pero no aristas repetidas.</p>
<p><strong>c.</strong> <span class="math inline">\(2 - 1 - 2 - 5 - 1 - 4\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Secuencia 2 - 1 - 2 - 5 - 1 - 4</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>V_cam3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>E_cam3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1-2"</span>, <span class="st">"2-1"</span>, <span class="st">"1-4"</span>, <span class="st">"1-5"</span>, <span class="st">"2-5"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g4)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g4)<span class="sc">$</span>name <span class="sc">%in%</span> V_cam3, <span class="st">"red"</span>, <span class="st">"white"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g4)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">apply</span>(<span class="fu">ends</span>(g4, <span class="fu">E</span>(g4)), <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">sort</span>(x), <span class="at">collapse=</span><span class="st">"-"</span>)) <span class="sc">%in%</span> E_cam3, <span class="st">"red"</span>, <span class="st">"gray"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3312</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g4, <span class="at">edge.arrow.size=</span><span class="dv">1</span>, <span class="at">vertex.size=</span><span class="dv">20</span>, <span class="at">vertex.label.cex=</span><span class="dv">1</span>, <span class="at">main=</span><span class="st">"Secuencia 2-1-2-5-1-4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Esta secuencia es una caminata abierta que tiene vertices y aristas repetidas.</p>
</section>
<section id="punto-5" class="level2">
<h2 class="anchored" data-anchor-id="punto-5">Punto 5</h2>
<p>Considere el conjunto de datos dado en <code>comtrade.RData</code> (este archivo contiene una arreglo de cuatro dimensiones denominado <code>comtrade</code>), asociado con el crecimiento anual del comercio (diferencia en dÃ³lares en escala logarÃ­tmica respecto al aÃ±o 2000). Este conjunto de datos involucra 30 paÃ­ses, 10 aÃ±os desde 1996 hasta 2005, y 6 clases de productos diferentes, como se muestra a continuaciÃ³n:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"comtrade.RData"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(comtrade)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1] "Australia"            "Austria"              "Brazil"              
 [4] "Canada"               "China"                "China, Hong Kong SAR"
 [7] "Czech Rep."           "Denmark"              "Finland"             
[10] "France"               "Germany"              "Greece"              
[13] "Indonesia"            "Ireland"              "Italy"               
[16] "Japan"                "Malaysia"             "Mexico"              
[19] "Netherlands"          "New Zealand"          "Norway"              
[22] "Rep. of Korea"        "Singapore"            "Spain"               
[25] "Sweden"               "Switzerland"          "Thailand"            
[28] "Turkey"               "United Kingdom"       "USA"                 

[[2]]
[1] "Chemicals"                                    
[2] "Crude materials, inedible, except fuels"      
[3] "Food and live animals"                        
[4] "Machinery and transport equipment"            
[5] "Manufact goods classified chiefly by material"
[6] "Miscellaneous manufactured articles"          

[[3]]
 [1] "1996" "1997" "1998" "1999" "2000" "2001" "2002" "2003" "2004" "2005"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#View(comtrade[1,2,,]) # Paises, paises, productos y aÃ±o</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>a. Calcule el aumento medio global</strong> <span class="math inline">\(\bar{y}\)</span> <strong>a lo largo de los 10 aÃ±os en bienes manufacturados. Para ello considere la matriz de adyacencia <code>Y</code> dada por:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="at">X =</span> comtrade[,,<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>),], <span class="at">MARGIN =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">FUN =</span> mean) <span class="co">#Media de aÃ±os y bienes manufacturados</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Y)[<span class="dv">1</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Y[<span class="fu">which</span>(<span class="fu">is.na</span>(Y))] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#** mean(y) **#</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(Y)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)),<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0378</code></pre>
</div>
</div>
<p><strong>b. Calcule la media de todas las observaciones de cada fila de <code>Y</code>, es decir, calcule la media fila</strong> <span class="math inline">\(\bar{y}_{i\bullet}=\frac{1}{n-1}\sum_{j:j\neq i} y_{i,j}\)</span> <strong>para cada paÃ­s. Realice una histograma de los promedios fila</strong> <span class="math inline">\(\bar{y}_{i\bullet}\)</span>. <strong>Los promedios fila caracterizan diferentes niveles de actividad de los nodos en tÃ©rminos de la sociabilidad. Â¿CÃ³mo se pueden interpretar los promedios fila</strong> <span class="math inline">\(\bar{y}_{i\bullet}\)</span>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mfila <span class="ot">&lt;-</span> <span class="fu">apply</span>(Y, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mfila <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Fila =</span> mfila, <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#hist(apply(Y, MARGIN = 1, FUN = mean))</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mfila, <span class="fu">aes</span>(<span class="at">x =</span> Fila)) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">bins =</span> <span class="dv">7</span>, <span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"purple"</span>, <span class="at">colour =</span> <span class="st">"black"</span>,<span class="at">lwd =</span> <span class="fl">0.1</span>,<span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Media de observaciones por fila ("</span>, <span class="fu">bar</span>(y)[i.], <span class="st">")"</span>)), <span class="at">x=</span><span class="st">"Media de crecimiento anual en bienes manufacturados"</span>, <span class="at">y=</span><span class="st">"Frecuencia"</span>) <span class="sc">+</span> mitema <span class="sc">+</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background=</span><span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">"black"</span>,<span class="at">fill=</span><span class="st">"gray80"</span>,<span class="at">size=</span><span class="dv">1</span>), <span class="at">strip.text=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">15</span>,<span class="at">vjust=</span><span class="fl">0.5</span>,<span class="at">hjust=</span><span class="fl">0.5</span>,<span class="at">color=</span><span class="st">"black"</span>,<span class="at">angle=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los promedios fila indican cuÃ¡nto aumenta o disminuye, en promedio, el comercio saliente (exportaciones) de bienes manufacturados del paÃ­s <span class="math inline">\(i\)</span> hacia los demÃ¡s paÃ­ses en comparaciÃ³n con el aÃ±o 2000. De acuerdo al histograma, la mayorÃ­a de los paises, en promedio, aumentaron su comercio saliente a menos de 0.05 con respecto al 2000. Por otro lado, un paÃ­s tuvo un comercio saliente promedio superior al de los demÃ¡s paÃ­ses, lo que lo posiciona como el mayor exportador en los aÃ±os de evaluaciÃ³n.</p>
<p><strong>c.&nbsp;Calcule la media de todas las observaciones de cada columna de <code>Y</code>, es decir, calcule la media columna</strong> <span class="math inline">\(\bar{y}_{\bullet j}=\frac{1}{n-1}\sum_{i:i\neq j} y_{i,j}\)</span> <strong>para cada paÃ­s. Realice una histograma de los promedios columna <span class="math inline">\(\bar{y}_{\bullet j}\)</span>. Los promedios columna caracterizan diferentes niveles de actividad de los nodos en tÃ©rminos de la popularidad. Â¿CÃ³mo se pueden interpretar los promedios columna</strong> <span class="math inline">\(\bar{y}_{\bullet j}\)</span>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mcol <span class="ot">&lt;-</span> <span class="fu">apply</span>(Y, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mcol <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Col =</span> mcol, <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#hist(apply(Y, MARGIN = 2, FUN = mean))</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mcol, <span class="fu">aes</span>(<span class="at">x =</span> Col)) <span class="sc">+</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">bins =</span> <span class="dv">7</span>, <span class="at">fill=</span><span class="st">"purple"</span>, <span class="at">colour =</span> <span class="st">"black"</span>,<span class="at">lwd =</span> <span class="fl">0.1</span>,<span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title=</span><span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Media de observaciones por columna ("</span>, <span class="fu">bar</span>(y)[.j], <span class="st">")"</span>)), <span class="at">x=</span><span class="st">"Media de crecimiento anual en bienes manufacturados"</span>, <span class="at">y=</span><span class="st">"Frecuencia"</span>) <span class="sc">+</span> mitema <span class="sc">+</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background=</span><span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">"black"</span>,<span class="at">fill=</span><span class="st">"gray80"</span>,<span class="at">size=</span><span class="dv">1</span>), <span class="at">strip.text=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">15</span>,<span class="at">vjust=</span><span class="fl">0.5</span>,<span class="at">hjust=</span><span class="fl">0.5</span>,<span class="at">color=</span><span class="st">"black"</span>,<span class="at">angle=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los promedios columna indican cuÃ¡nto aumenta o disminuye, en promedio, el comercio entrante (importaciones) de bienes manufacturados hacia un paÃ­s <span class="math inline">\(i\)</span> desde los demÃ¡s paÃ­ses en comparaciÃ³n con el aÃ±o 2000. De acuerdo al histograma, algunos paÃ­ses, en promedio, disminuyeron su comercio entrante con respecto al 2000. Mientras que algunos pocos aumentaron sus importaciones a mas del 0.10 con el respecto al aÃ±o 2000, lo que los posiciona como los mayores importadores en los aÃ±os de evaluaciÃ³n.</p>
<p><strong>d.&nbsp;Calcule tanto la media de los promedios fila</strong> <span class="math inline">\(\bar{y}_{i\bullet}\)</span> <strong>como la media de los promedios columna</strong> <span class="math inline">\(\bar{y}_{\bullet j}\)</span>. <strong>QuÃ© se puede concluir acerca de la tendencia local en este caso?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>meand <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">round</span>(<span class="fu">mean</span>(mfila[,<span class="dv">1</span>]), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">mean</span>(mcol[,<span class="dv">1</span>]), <span class="dv">4</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(meand) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Media promedios fila"</span>, <span class="st">"Media promedios columna"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(meand) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(meand, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Media promedios fila</th>
<th style="text-align: center;">Media promedios columna</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.0365</td>
<td style="text-align: center;">0.0365</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>La media de los promedios fila y de los promedios columna es igual por como estÃ¡n definidas las medidas. Su valor es de 0.0365, el cual es cercano a 0, lo que indica que hubo un leve nivel de crecimiento econÃ³mico tanto saliente como entrante de bienes manufacturados en comparaciÃ³n con el aÃ±o 2000, en la red.</p>
<p><strong>e. Calcule tanto la DE de los promedios fila</strong> <span class="math inline">\(\bar{y}_{i\bullet}\)</span> <strong>como la DE de los promedios columna</strong> <span class="math inline">\(\bar{y}_{\bullet j}\)</span>. <strong>Â¿QuÃ© se puede concluir acerca de la heterogeneidad local en este caso?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sde <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">round</span>(<span class="fu">sd</span>(mfila[,<span class="dv">1</span>]), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">sd</span>(mcol[,<span class="dv">1</span>]), <span class="dv">4</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sde) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DE promedios fila"</span>, <span class="st">"DE promedios columna"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sde) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(sde, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">DE promedios fila</th>
<th style="text-align: center;">DE promedios columna</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.0292</td>
<td style="text-align: center;">0.0396</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>La desviaciÃ³n estÃ¡ndar de los promedios fila es inferior a la desviaciÃ³n estÃ¡ndar de los promedios columna, lo que indica que hay mayor heterogeneidad entre los niveles de importaciÃ³n de cada paÃ­s que entre los de exportaciÃ³n. AsÃ­, en cuanto al nivel de exportaciÃ³n, el comercio saliente de los paÃ­ses dista, en promedio, 0.0292 de la media, mientras que el comercio entrante de los paÃ­ses dista, en promedio, 0.0396 de la media.</p>
<p><strong>f.&nbsp;Calcule el coeficiente de correlaciÃ³n entre los promedios fila</strong> <span class="math inline">\(\bar{y}_{i\bullet}\)</span> <strong>y los promedios columna</strong> <span class="math inline">\(\bar{y}_{\bullet j}\)</span>. <strong>Realice un dispersograma de los promedios columna</strong> <span class="math inline">\(\bar{y}_{\bullet j}\)</span> <strong>(eje</strong> <span class="math inline">\(y\)</span><strong>) frente a los promedios fila</strong> <span class="math inline">\(\bar{y}_{i\bullet}\)</span> <strong>(eje</strong> <span class="math inline">\(x\)</span><strong>), junto con la recta</strong> <span class="math inline">\(y=x\)</span> <strong>como punto de referencia. Â¿QuÃ© se puede concluir?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tabf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mfila, mcol)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Coeficiente de correlacion</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coeficiente de correlaciÃ³n:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(tabf)[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coeficiente de correlaciÃ³n: 0.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafico</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tabf,<span class="fu">aes</span>(<span class="at">x=</span>Fila,<span class="at">y=</span>Col)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"red"</span>,<span class="at">shape=</span><span class="dv">16</span>,<span class="at">size=</span><span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Promedios fila versus promedios columna"</span>,<span class="at">x=</span><span class="st">"Promedios exportaciones"</span>,<span class="at">y=</span><span class="st">"Promedios importaciones"</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a> mitema</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El coeficiente de correlaciÃ³n lineal entre los promedios fila y los promedios columna es de 0.7, lo que indica que hay una relaciÃ³n lineal alta. AsÃ­, si el promedio de exportaciones de un paÃ­s <span class="math inline">\(i\)</span> es alto, su promedio de importaciones tambiÃ©n lo serÃ¡. Por otro lado, segÃºn el dispersograma, el promedio de las exportaciones y de las importaciones en los paÃ­ses tiende a mantener una magnitud y signo similar que puede ser representada por la recta <span class="math inline">\(x=y\)</span>, por supuesto, con la presencia de ciertos paÃ­ses que parecen no seguir dicha relaciÃ³n.</p>
</section>
<section id="punto-6" class="level2">
<h2 class="anchored" data-anchor-id="punto-6">Punto 6</h2>
<p>Considere el conjunto de datos dado en <code>conflict.RData</code> recopilado por Mike Ward y Xun Cao del departamento de Ciencias PolÃ­ticas de la Universidad de Washington, asociado con datos de conflictos entre paÃ­ses en los aÃ±os 90. El archivo <code>conflict.RData</code> contiene una lista con tres arreglos, <code>X</code>, <code>Y</code>, y <code>D</code>. <code>X</code> tiene tres campos: <code>population</code> (poblaciÃ³n en millones), <code>gdp</code> (PIB en millones de dolares) <code>polity</code> (puntuaciÃ³n polÃ­tica, un Ã­ndice de democracia). <code>Y</code> hace referencia a una matriz <span class="math inline">\(\mathbf{Y}=[y_{i,j}]\)</span> en la que <span class="math inline">\(y_{i,j}\)</span> representa el nÃºmero de conflictos iniciados por el paÃ­s <span class="math inline">\(i\)</span> hacia el paÃ­s <span class="math inline">\(j\)</span>. Finalmente, <code>D</code>es un arreglo de tres dimensiones dimensiones cuya tercera dimensiÃ³n contiene indices entre cada par de paÃ­ses asociados con: comercio (dimensiÃ³n 1), importaciones (dimensiÃ³n 2), organizaciones intergubernamentales (dimensiÃ³n 3), y distancia geogrÃ¡fica (dimensiÃ³n 4).</p>
<p><strong>a. Hacer una visualizaciÃ³n decorada de la red de conflictos teniendo en cuenta diferentes diseÃ±os.</strong></p>
<p>Teniendo en cuenta la fuerza, se determina el tamaÃ±o del nodo. AdemÃ¡s, los paÃ­ses con Ã­ndice de democracio mayor que 0 son de color azul claro, mientras que los demÃ¡s de color azul oscuro.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"conflict.RData"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>g6 <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(dat<span class="sc">$</span>Y, <span class="at">mode =</span> <span class="st">"directed"</span>, <span class="at">weighted =</span> <span class="cn">TRUE</span>, <span class="at">diag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombres de vÃ©rtices</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g6)<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dat<span class="sc">$</span>X)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficos interactivos</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># OpciÃ³n 1</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#simpleNetwork(data.frame(as_edgelist(g6)))</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># OpciÃ³n 2</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">V</span>(g6)<span class="sc">$</span>name)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(<span class="fu">nrow</span>(nodes) <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># IDs numÃ©ricos empezando en 0</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>pob <span class="ot">&lt;-</span> dat<span class="sc">$</span>X[,<span class="dv">1</span>]</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>nodesize <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g6)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>polity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>X[,<span class="dv">3</span>] <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"polity &gt; 0"</span>, <span class="st">"polity &lt; 0"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>gdp <span class="ot">&lt;-</span> dat<span class="sc">$</span>X[,<span class="dv">2</span>]</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> <span class="fu">as_data_frame</span>(g6, <span class="at">what =</span> <span class="st">"edges"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>source_id <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>from, nodes<span class="sc">$</span>name) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>target_id <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>to, nodes<span class="sc">$</span>name) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Layout </span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1208</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co"># b&lt;-layout_as_star(g6); c&lt;-layout_as_tree(g6);d&lt;-layout_in_circle(g6);f&lt;-layout_on_grid(g6);g&lt;-layout_on_sphere(g6);i&lt;-layout_with_dh(g6);j&lt;-layout_with_fr(g6);k&lt;-layout_with_gem(g6);l&lt;-layout_with_graphopt(g6);m&lt;-layout_with_kk(g6);n&lt;-layout_with_lgl(g6);o&lt;-layout_with_mds(g6);p&lt;-layout_with_sugiyama(g6)</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>e<span class="ot">&lt;-</span><span class="fu">layout_nicely</span>(g6)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g6)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>X[,<span class="dv">3</span>] <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"lightblue"</span>, <span class="st">"blue"</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">#  Teniendo en cuenta la fuerza</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g6, <span class="at">layout =</span> e, <span class="at">vertex.size =</span> <span class="dv">7</span><span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">strength</span>(g6, <span class="at">weights =</span> <span class="cn">NA</span>)), <span class="at">vertex.label =</span> <span class="cn">NA</span>,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">adjustcolor</span>(<span class="fu">V</span>(g6)<span class="sc">$</span>color, <span class="fl">0.4</span>),</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.color =</span> <span class="fu">adjustcolor</span>(<span class="st">"gray"</span>, <span class="fl">0.4</span>), <span class="at">edge.arrow.size =</span> <span class="fl">0.3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" data-fig-pos="H"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#title(main = "Red de Conflictos", outer = TRUE, line = -2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Teniendo en cuenta el tamaÃ±o de la poblaciÃ³n, se determina el tamaÃ±o del nodo. AdemÃ¡s, los paÃ­ses con Ã­ndice de democracio mayor que 0 son de color naranja, mientras que los demÃ¡s de color azul.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teniendo en cuenta la poblacion</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">forceNetwork</span>(<span class="at">Links =</span> links, <span class="at">Nodes =</span> nodes,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">Source =</span> <span class="st">"source_id"</span>, <span class="at">Target =</span> <span class="st">"target_id"</span>, <span class="at">linkColour =</span> <span class="st">"gray"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">NodeID =</span> <span class="st">"name"</span>, <span class="at">Group =</span> <span class="st">"polity"</span>, <span class="at">Nodesize =</span> <span class="st">"pob"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">radiusCalculation=</span><span class="st">"Math.sqrt(d.nodesize)*0.8"</span>, <span class="at">fontSize =</span> <span class="dv">20</span>,  <span class="at">legend=</span><span class="cn">TRUE</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">opacity =</span> <span class="fl">0.9</span>, <span class="at">colourScale =</span> <span class="fu">JS</span>(<span class="st">"d3.scaleOrdinal(d3.schemeCategory10);"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="forceNetwork html-widget html-fill-item" id="htmlwidget-bc67a13c57771957395b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bc67a13c57771957395b">{"x":{"links":{"source":[0,3,3,4,5,7,12,14,16,19,19,19,20,23,25,25,25,25,25,25,29,30,31,34,35,35,35,35,35,35,37,37,37,41,41,41,44,44,46,46,46,48,48,48,51,51,53,53,53,54,54,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,59,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,63,65,65,66,67,70,77,77,82,82,82,83,83,83,83,83,84,86,86,87,88,91,95,95,95,95,95,95,96,97,97,99,99,99,99,99,100,101,102,102,102,103,103,104,108,109,109,110,113,113,114,114,114,115,116,116,117,120,120,120,120,120,121,122,122,122,122,122,122,122,123,123,123,125,125,125,125,125,125,125,125,125,125,125,126,126,126],"target":[56,28,35,50,54,57,53,79,115,50,107,125,83,84,62,75,91,97,114,125,82,125,120,50,3,8,28,99,122,128,56,57,109,50,57,95,104,117,1,57,120,21,65,104,82,101,12,88,92,25,92,0,57,120,121,125,4,5,7,8,12,19,37,41,46,58,59,62,76,84,86,87,88,96,102,103,104,107,113,120,121,123,125,57,61,113,57,4,5,7,8,12,19,37,41,46,57,59,76,84,86,87,88,96,102,103,104,107,113,120,121,123,125,95,97,114,122,21,48,100,23,105,12,116,26,29,51,9,21,23,65,104,74,50,57,57,53,25,5,19,25,62,97,125,102,62,95,3,23,35,79,129,66,82,57,96,127,45,68,65,53,37,122,78,120,125,25,62,91,16,18,77,44,31,46,56,57,113,57,3,23,35,79,99,109,129,24,50,57,0,19,30,50,56,57,65,67,95,109,126,26,49,118],"colour":["gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray"]},"nodes":{"name":["AFG","ALB","ALG","ANG","ARG","AUL","AUS","BAH","BEL","BEN","BFO","BHU","BNG","BOL","BOT","BRA","BUI","BUL","CAM","CAN","CAO","CDI","CEN","CHA","CHL","CHN","COL","COM","CON","COS","CUB","CYP","DEN","DJI","DOM","DRC","ECU","EGY","EQG","FIN","FJI","FRN","GAB","GAM","GHA","GNB","GRC","GUA","GUI","GUY","HAI","HON","HUN","IND","INS","IRE","IRN","IRQ","ISR","ITA","JAM","JOR","JPN","KEN","LAO","LBR","LES","LIB","MAA","MAG","MAL","MAS","MAW","MEX","MLI","MON","MOR","MYA","MZM","NAM","NEP","NEW","NIC","NIG","NIR","NOR","NTH","OMA","PAK","PAN","PAR","PHI","PNG","POL","POR","PRK","QAT","ROK","RUM","RWA","SAF","SAL","SAU","SEN","SIE","SIN","SOM","SPN","SRI","SUD","SWA","SWD","SWZ","SYR","TAW","TAZ","THI","TOG","TRI","TUN","TUR","UAE","UGA","UKG","URU","USA","VEN","YEM","ZAM","ZIM"],"group":["polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity < 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity < 0","polity < 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0"],"nodesize":[24.78,3.28,27.89,10.66,34.77,18.1,7.99,0.57,10.12,5.49,10.02,0.8100000000000001,120.3,7.43,1.45,159.32,6.15,8.43,13.18,29.3,11.27,13.71,3.31,6.69,14.18,1201.23,38.58,0.49,2.58,3.38,10.95,0.72,5.23,0.5600000000000001,7.77,43.24,11.46,58.18,0.4,5.1,0.77,59.28,1.09,1.11,17.1,1.08,10.42,10.01,6.59,0.79,7.14,5.64,10.22,930.96,194.13,3.62,59,16.37,5.52,57.25,2.51,4.15,125.37,26.96,4.55,2.27,1.9,4.43,2.32,12.27,20.66,1.12,9.52,90.67,9.66,2.4,26.38,40.81,15.85,1.55,20.98,3.64,4.44,111.37,9.199999999999999,4.36,15.44,1.98,122.62,2.63,4.84,69.45999999999999,4.4,38.5,9.92,20.53,0.62,45.09,22.72,7.38,39.05,5.68,18.05,8.369999999999999,4.51,3.55,7.57,39.26,18.12,26.61,0.77,8.77,7,14.14,21.16,29.62,58.71,4.04,1.26,8.92,61.59,1.54,19.23,58.63,3.22,262.95,21.84,15.13,8.960000000000001,11.15]},"options":{"NodeID":"name","Group":"polity","colourScale":"d3.scaleOrdinal(d3.schemeCategory10);","fontSize":20,"fontFamily":"serif","clickTextSize":50,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-30,"opacity":0.9,"zoom":false,"legend":true,"arrows":false,"nodesize":true,"radiusCalculation":"Math.sqrt(d.nodesize)*0.8","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Teniendo en cuenta el PIB, se determina el tamaÃ±o del nodo. AdemÃ¡s, los paÃ­ses con Ã­ndice de democracio mayor que 0 son de color naranja, mientras que los demÃ¡s de color azul.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teniendo en cuenta el PIB</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">forceNetwork</span>(<span class="at">Links =</span> links, <span class="at">Nodes =</span> nodes,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">Source =</span> <span class="st">"source_id"</span>, <span class="at">Target =</span> <span class="st">"target_id"</span>, <span class="at">linkColour =</span> <span class="st">"gray"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">NodeID =</span> <span class="st">"name"</span>, <span class="at">Group =</span> <span class="st">"polity"</span>, <span class="at">Nodesize =</span> <span class="st">"gdp"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">radiusCalculation=</span><span class="st">"Math.sqrt(d.nodesize)*0.5"</span>, <span class="at">fontSize =</span> <span class="dv">20</span>,  <span class="at">legend=</span><span class="cn">TRUE</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">opacity =</span> <span class="fl">0.9</span>, <span class="at">colourScale =</span> <span class="fu">JS</span>(<span class="st">"d3.scaleOrdinal(d3.schemeCategory10);"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="forceNetwork html-widget html-fill-item" id="htmlwidget-c4d8d306b6f4d36b2aa3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c4d8d306b6f4d36b2aa3">{"x":{"links":{"source":[0,3,3,4,5,7,12,14,16,19,19,19,20,23,25,25,25,25,25,25,29,30,31,34,35,35,35,35,35,35,37,37,37,41,41,41,44,44,46,46,46,48,48,48,51,51,53,53,53,54,54,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,59,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,63,65,65,66,67,70,77,77,82,82,82,83,83,83,83,83,84,86,86,87,88,91,95,95,95,95,95,95,96,97,97,99,99,99,99,99,100,101,102,102,102,103,103,104,108,109,109,110,113,113,114,114,114,115,116,116,117,120,120,120,120,120,121,122,122,122,122,122,122,122,123,123,123,125,125,125,125,125,125,125,125,125,125,125,126,126,126],"target":[56,28,35,50,54,57,53,79,115,50,107,125,83,84,62,75,91,97,114,125,82,125,120,50,3,8,28,99,122,128,56,57,109,50,57,95,104,117,1,57,120,21,65,104,82,101,12,88,92,25,92,0,57,120,121,125,4,5,7,8,12,19,37,41,46,58,59,62,76,84,86,87,88,96,102,103,104,107,113,120,121,123,125,57,61,113,57,4,5,7,8,12,19,37,41,46,57,59,76,84,86,87,88,96,102,103,104,107,113,120,121,123,125,95,97,114,122,21,48,100,23,105,12,116,26,29,51,9,21,23,65,104,74,50,57,57,53,25,5,19,25,62,97,125,102,62,95,3,23,35,79,129,66,82,57,96,127,45,68,65,53,37,122,78,120,125,25,62,91,16,18,77,44,31,46,56,57,113,57,3,23,35,79,99,109,129,24,50,57,0,19,30,50,56,57,65,67,95,109,126,26,49,118],"colour":["gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray"]},"nodes":{"name":["AFG","ALB","ALG","ANG","ARG","AUL","AUS","BAH","BEL","BEN","BFO","BHU","BNG","BOL","BOT","BRA","BUI","BUL","CAM","CAN","CAO","CDI","CEN","CHA","CHL","CHN","COL","COM","CON","COS","CUB","CYP","DEN","DJI","DOM","DRC","ECU","EGY","EQG","FIN","FJI","FRN","GAB","GAM","GHA","GNB","GRC","GUA","GUI","GUY","HAI","HON","HUN","IND","INS","IRE","IRN","IRQ","ISR","ITA","JAM","JOR","JPN","KEN","LAO","LBR","LES","LIB","MAA","MAG","MAL","MAS","MAW","MEX","MLI","MON","MOR","MYA","MZM","NAM","NEP","NEW","NIC","NIG","NIR","NOR","NTH","OMA","PAK","PAN","PAR","PHI","PNG","POL","POR","PRK","QAT","ROK","RUM","RWA","SAF","SAL","SAU","SEN","SIE","SIN","SOM","SPN","SRI","SUD","SWA","SWD","SWZ","SYR","TAW","TAZ","THI","TOG","TRI","TUN","TUR","UAE","UGA","UKG","URU","USA","VEN","YEM","ZAM","ZIM"],"group":["polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity < 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity < 0","polity < 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0"],"nodesize":[19.29,8.949999999999999,133.61,15.38,352.38,408.06,170.76,7.45,215.01,6.03,9.050000000000001,1.43,177.32,19.32,9.17,1057.43,4.35,53.9,26.03,686.09,14.8,26.97,3.58,6.24,118.78,3342.66,205.38,0.87,4.84,17.95,59.8,10.7,124.27,1.13,30.99,15.61,43.24,215.19,0.77,101.82,3.96,1214.34,9.51,1.26,21.26,0.76,133.86,37.57,17.48,2.24,11.2,11.97,92.63,1887.02,675.7,66.92,295.73,71.2,86.59,1165.54,9.59,15.31,2947.66,34.22,7.02,2.43,2.68,28.06,2.99,10.27,175.51,12.69,6.62,694.39,8.1,3.94,96.51000000000001,33.84,14.71,6.73,26.56,62.38,8.199999999999999,105.03,7.86,104.47,330.44,29.99,232.03,14.94,24.56,216.39,14.37,287.34,135.82,19.96,12.66,588.9,101.24,6.55,290.62,23.13,208.14,12.53,4.16,81.68000000000001,7.96,619.7,53.48,29.4,2.65,184.75,176.09,53.24,309.53,13.86,364.66,4.03,12.04,51.32,387.3,38.33,15.74,1158.41,28.69,7619.7,152.33,13.55,8.08,30.17]},"options":{"NodeID":"name","Group":"polity","colourScale":"d3.scaleOrdinal(d3.schemeCategory10);","fontSize":20,"fontFamily":"serif","clickTextSize":50,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-30,"opacity":0.9,"zoom":false,"legend":true,"arrows":false,"nodesize":true,"radiusCalculation":"Math.sqrt(d.nodesize)*0.5","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>b. Calcule e interprete la media global.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat<span class="sc">$</span>Y)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Media global:"</span>, <span class="fu">round</span>(<span class="fu">sum</span>(dat<span class="sc">$</span>Y)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)),<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Media global: 0.0182</code></pre>
</div>
</div>
<p>La media global de la red es cercana a 0, lo que indica que hay pocas posibilidades de que dos paÃ­ses tengan alguna relaciÃ³n de conflicto, omitiendo si los paÃ­ses son propensos a recibir u omitir este tipo de relaciones.</p>
<p><strong>c.&nbsp;Obtenga y grafique la distribuciÃ³n del <em>out-degree</em> y del <em>in-degree</em>. Calcule e interprete la media y la desviaciÃ³n estÃ¡ndar de esta distribuciÃ³n.</strong></p>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dout <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g6, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>dtdout <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(<span class="fu">factor</span>(dout, <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">names</span>(<span class="fu">table</span>(dout))[<span class="fu">length</span>(<span class="fu">table</span>(dout))])))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dtdout) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Grado"</span>, <span class="st">"Frec"</span>) </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>dtdout[,<span class="dv">2</span>] <span class="ot">&lt;-</span> dtdout[,<span class="dv">2</span>]<span class="sc">/</span>n</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dtdout, <span class="fu">aes</span>(<span class="at">x =</span> Grado, <span class="at">weight=</span>Frec)) <span class="sc">+</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(),<span class="at">width=</span><span class="fl">0.75</span>, <span class="at">fill=</span> <span class="st">"purple"</span>) <span class="sc">+</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="fl">0.5</span>,<span class="at">by=</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">30</span>,<span class="at">by=</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"DistribuciÃ³n del grado de salida"</span>, <span class="at">x=</span><span class="st">"Grado de salida"</span>, <span class="at">y=</span><span class="st">"Densidad"</span>)<span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>mitema </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>din <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g6, <span class="at">mode =</span> <span class="st">"in"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>dtdin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(<span class="fu">factor</span>(din, <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">names</span>(<span class="fu">table</span>(din))[<span class="fu">length</span>(<span class="fu">table</span>(din))])))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dtdin) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Grado"</span>, <span class="st">"Frec"</span>) </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>dtdin[,<span class="dv">2</span>] <span class="ot">&lt;-</span> dtdin[,<span class="dv">2</span>]<span class="sc">/</span>n</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dtdin, <span class="fu">aes</span>(<span class="at">x =</span> Grado, <span class="at">weight=</span>Frec)) <span class="sc">+</span> </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(),<span class="at">width=</span><span class="fl">0.75</span>, <span class="at">fill=</span> <span class="st">"purple"</span>) <span class="sc">+</span> </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="fl">0.5</span>,<span class="at">by=</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">30</span>,<span class="at">by=</span><span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"DistribuciÃ³n del grado de entrada"</span>, <span class="at">x=</span><span class="st">"Grado de entrada"</span>, <span class="at">y=</span><span class="st">"Densidad"</span>)<span class="sc">+</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>mitema </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Taller2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Taller2_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>meand <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(<span class="fu">round</span>(<span class="fu">mean</span>(din), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">mean</span>(dout), <span class="dv">4</span>)), <span class="fu">cbind</span>(<span class="fu">round</span>(<span class="fu">sd</span>(din), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">sd</span>(dout), <span class="dv">4</span>)))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(meand) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Grado de entrada"</span>, <span class="st">"Grado de salida"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(meand) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Media"</span>, <span class="st">"DesviaciÃ³n estÃ¡ndar"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(meand, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Grado de entrada</th>
<th style="text-align: center;">Grado de salida</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Media</td>
<td style="text-align: center;">1.5615</td>
<td style="text-align: center;">1.5615</td>
</tr>
<tr class="even">
<td style="text-align: left;">DesviaciÃ³n estÃ¡ndar</td>
<td style="text-align: center;">1.9845</td>
<td style="text-align: center;">3.5894</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>La media del grado de entrada y de salida es de 1.56, lo que indica que, en promedio, los paÃ­ses inician o reciben un conflicto aproximadamente dos veces con otro paÃ­ses. Sin embargo, existe mayor heterogeneidad en las relaciones de conflicto que emiten los paÃ­ses, que entre las que reciben.</p>
<p>Por otro lado, de acuerdo con las distribuciones de los grados de entrada como de salida, pocos paÃ­ses inician o reciben relaciones de conflicto mÃ¡s de 15 veces, por lo que estos paÃ­ses podrÃ­an ser centros o autoridades.</p>
<p><strong>d.&nbsp;Calcule el coeficiente de correlaciÃ³n entre los valores del <em>out-degree</em> y el <em>in-degree</em>. Realice un dispersograma de los grados de entrada (eje</strong> <span class="math inline">\(y\)</span><strong>) frente a los grados de salida (eje</strong><span class="math inline">\(x\)</span><strong>), junto con la recta</strong> <span class="math inline">\(y=x\)</span> <strong>como punto de referencia. Â¿QuÃ© se puede concluir?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tabd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(din, dout)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Coeficiente de correlacion</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coeficiente de correlaciÃ³n:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(tabd)[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coeficiente de correlaciÃ³n: 0.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafico</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tabd,<span class="fu">aes</span>(<span class="at">x=</span>dout,<span class="at">y=</span>din)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"red"</span>,<span class="at">shape=</span><span class="dv">16</span>,<span class="at">size=</span><span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Grados de entrada versus grados de salida"</span>,<span class="at">x=</span><span class="st">"Grados de salida"</span>,<span class="at">y=</span><span class="st">"Grados de entrada"</span>) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a> mitema</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El coeficiente de correlaciÃ³n lineal entre los grados de entrada y de salida es de 0.6, lo que indica que hay una relaciÃ³n lineal moderada. AsÃ­, si las relaciones de conflicto que un paÃ­s inicia hacia otro aumentan, las relaciones de conflicto recibidas tambiÃ©n lo hacen, pero de manera moderada.</p>
<p>Por otro lado, segÃºn el dispersograma, la mayorÃ­a de los paÃ­ses tienen menos de 5 conflictos iniciados y recibidos, pero existen dos paÃ­ses que tienen mÃ¡s de 20 conflictos iniciados hacia otros paÃ­ses y uno de ellos ha recibido 15 relaciones de conflicto.</p>
<p><strong>e. Identifique los paÃ­ses mas activos.</strong></p>
<p><strong>Por grado</strong></p>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># De entrada</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>topdin <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(din,<span class="at">decreasing =</span> T),<span class="dv">5</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">Vertice =</span> <span class="fu">names</span>(topdin), <span class="at">GradoIn =</span> topdin, <span class="at">row.names =</span> <span class="cn">NULL</span>), <span class="at">align =</span> <span class="st">'c'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># De salida</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>topdout <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(dout, <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">Vertice =</span> <span class="fu">names</span>(topdout), <span class="at">GradoOut =</span> topdout, <span class="at">row.names =</span> <span class="cn">NULL</span>), <span class="at">align =</span> <span class="st">'c'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Vertice</th>
<th style="text-align: center;">GradoIn</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">IRQ</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;">USA</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">HAI</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: center;">TUR</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">JPN</td>
<td style="text-align: center;">5</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Vertice</th>
<th style="text-align: center;">GradoOut</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">IRQ</td>
<td style="text-align: center;">27</td>
</tr>
<tr class="even">
<td style="text-align: center;">JOR</td>
<td style="text-align: center;">26</td>
</tr>
<tr class="odd">
<td style="text-align: center;">USA</td>
<td style="text-align: center;">11</td>
</tr>
<tr class="even">
<td style="text-align: center;">UGA</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">CHN</td>
<td style="text-align: center;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Teniendo en cuenta el grado de entrada, el pais mÃ¡s activo en cuanto a recibir relaciones de conflicto es IRAQ, pues es el que mÃ¡s paises le han omitido este tipo de relaciones. De acuerdo al grado de salida, los paises mÃ¡s propensos a emitir relaciones de conflicto son IRAQ y JORDANIA, pues son los que mÃ¡s se han dirigido hacia otros paises con relaciones de conflicto.</p>
<p><strong>Por fuerza</strong></p>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># De entrada</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>topwdin <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(<span class="fu">strength</span>(g6, <span class="at">mode =</span> <span class="st">"in"</span>), <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">Vertice =</span> <span class="fu">names</span>(topwdin), <span class="at">FuerzaIn =</span> topwdin, <span class="at">row.names =</span> <span class="cn">NULL</span>), <span class="at">align =</span> <span class="st">'c'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># De salida</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>topwdout <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(<span class="fu">strength</span>(g6, <span class="at">mode =</span> <span class="st">"out"</span>), <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">Vertice =</span> <span class="fu">names</span>(topwdout), <span class="at">FuerzaOut =</span> topwdout, <span class="at">row.names =</span> <span class="cn">NULL</span>), <span class="at">align =</span> <span class="st">'c'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Vertice</th>
<th style="text-align: center;">FuerzaIn</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">IRQ</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: center;">USA</td>
<td style="text-align: center;">13</td>
</tr>
<tr class="odd">
<td style="text-align: center;">GRC</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">JPN</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="odd">
<td style="text-align: center;">CHN</td>
<td style="text-align: center;">8</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Vertice</th>
<th style="text-align: center;">FuerzaOut</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">IRQ</td>
<td style="text-align: center;">30</td>
</tr>
<tr class="even">
<td style="text-align: center;">JOR</td>
<td style="text-align: center;">26</td>
</tr>
<tr class="odd">
<td style="text-align: center;">TUR</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="even">
<td style="text-align: center;">USA</td>
<td style="text-align: center;">18</td>
</tr>
<tr class="odd">
<td style="text-align: center;">PRK</td>
<td style="text-align: center;">16</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Teniendo en cuenta la fuerza de entrada, los paises mÃ¡s propensos a recibir relaciones de conflicto son IRAQ y USA, pues estos son los que mÃ¡s han recibido relaciones de conflicto desde otros paises. De acuerdo a la fuerza de salida, los paises mÃ¡s propensos a emitir relaciones de conflicto son IRAQ, JORDANIA y TURQUIA pues estos son los que mÃ¡s han iniciado relaciones de conflicto hacia otros paises.</p>
<p><strong>Centros o autoridades</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Centros</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>hs <span class="ot">&lt;-</span> <span class="fu">round</span>(igraph<span class="sc">::</span><span class="fu">hub_score</span>(<span class="at">graph =</span> g6, <span class="at">scale =</span> T)<span class="sc">$</span>vector,<span class="dv">2</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(hs,<span class="at">decreasing =</span> T),<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> TUR  USA  IRN  UKG  FRN 
1.00 0.78 0.64 0.52 0.42 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autoridades</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>as <span class="ot">&lt;-</span> <span class="fu">round</span>(igraph<span class="sc">::</span><span class="fu">authority_score</span>(<span class="at">graph =</span> g6, <span class="at">scale =</span> T)<span class="sc">$</span>vector, <span class="dv">2</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(as,<span class="at">decreasing =</span> T),<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> IRQ  GRC  CYP  IRN  SYR 
1.00 0.39 0.14 0.14 0.12 </code></pre>
</div>
</div>
<p>Los paÃ­ses que mÃ¡s relaciones emiten a paÃ­ses centrales en las relciones de conflicto son TURQUIA, USA e IRAN. Mientras que los paÃ­ses que mÃ¡s relaciones reciben de estos paÃ­ses centrales son IRAQ y GRECIA.</p>
</section>
<section id="punto-7" class="level2">
<h2 class="anchored" data-anchor-id="punto-7">Punto 7</h2>
<p>Para todos los vÃ©rtices de los cuatro grafos que se presentan a continuaciÃ³n, calcular el grado y las medidas de centralidad. Para cada grafo completar e interpretar la siguiente tabla. Interpretar los resultados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funcion</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fun7 <span class="ot">&lt;-</span> <span class="cf">function</span>(grafo){</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Grado</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(<span class="at">graph =</span> grafo)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Centralidad de cercanÃ­a</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  clss <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">closeness</span>(<span class="at">graph =</span> grafo, <span class="at">normalized =</span> T)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Centralidad de intermediaciÃ³n</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  btw <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(<span class="at">graph =</span> grafo, <span class="at">normalized =</span> T)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Centralidad de propia</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  ev <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">eigen_centrality</span>(<span class="at">graph =</span> grafo, <span class="at">scale =</span> T)<span class="sc">$</span>vector</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  tabla <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Medida =</span> <span class="fu">c</span>(<span class="st">"Media"</span>, <span class="st">"Desviacion estÃ¡ndar"</span>),</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Grado =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(d),<span class="dv">2</span>), <span class="fu">round</span>(<span class="fu">sd</span>(d), <span class="dv">2</span>)),</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cercania =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(clss),<span class="dv">2</span>), <span class="fu">round</span>(<span class="fu">sd</span>(clss), <span class="dv">2</span>)),</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intermediacion =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(btw),<span class="dv">2</span>), <span class="fu">round</span>(<span class="fu">sd</span>(btw), <span class="dv">2</span>)),</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Propia =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(ev),<span class="dv">2</span>), <span class="fu">round</span>(<span class="fu">sd</span>(ev), <span class="dv">2</span>))</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Grado =</span> d, <span class="at">Cercania =</span> clss, <span class="at">Intermediacion =</span> btw, <span class="at">Propia=</span> ev, <span class="at">Tabla =</span> tabla))</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Grafo1</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">graph_from_literal</span>(<span class="dv">2-1</span>, <span class="dv">3-1</span>, <span class="dv">4-1</span>, <span class="dv">5-1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g1, <span class="at">vertex.size=</span><span class="dv">35</span>, <span class="at">vertex.color=</span><span class="st">"gray"</span>, <span class="at">edge.color=</span><span class="st">"gray"</span>, <span class="at">vertex.label.cex=</span><span class="dv">1</span>, <span class="at">vertex.label.color=</span><span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>ResumÃ©n de vÃ©rtices y de grafo</em></p>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>G1 <span class="ot">=</span> <span class="fu">fun7</span>(g1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `scale` argument of `eigen_centrality()` is deprecated as of igraph 2.1.1.
â¹ eigen_centrality() will always behave as if scale=TRUE were used.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen vertice </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>ResV <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">Grado =</span> G1<span class="sc">$</span>Grado, <span class="at">Cernacia =</span> <span class="fu">round</span>(G1<span class="sc">$</span>Cercania, <span class="dv">2</span>), <span class="at">Intermediacion =</span> <span class="fu">round</span>(G1<span class="sc">$</span>Intermediacion, <span class="dv">2</span>), <span class="at">Propia =</span> <span class="fu">round</span>(G1<span class="sc">$</span>Propia, <span class="dv">2</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>ResV <span class="ot">&lt;-</span> ResV[, <span class="fu">order</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(ResV)))]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ResV, <span class="at">align=</span><span class="st">"c"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen grafo</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(G1<span class="sc">$</span>Tabla, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Grado</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cernacia</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">0.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Intermediacion</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Propia</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.50</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Medida</th>
<th style="text-align: center;">Grado</th>
<th style="text-align: center;">Cercania</th>
<th style="text-align: center;">Intermediacion</th>
<th style="text-align: center;">Propia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Media</td>
<td style="text-align: center;">1.60</td>
<td style="text-align: center;">0.66</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.60</td>
</tr>
<tr class="even">
<td style="text-align: center;">Desviacion estÃ¡ndar</td>
<td style="text-align: center;">1.34</td>
<td style="text-align: center;">0.19</td>
<td style="text-align: center;">0.45</td>
<td style="text-align: center;">0.22</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>SegÃºn la tabla de resumen del grafo, cada nodo tiene en promedio 1 relaciÃ³n con otro nodo.</p>
<p>En promedio, cada nodo es moderadamente cercano a los otros y cada uno dista, en promedio, 0.19 de la medida de cercanÃ­a, lo que los hace homogÃ©neos.</p>
<p>En promedio, los nodos tienden a no estar entre otros pares de nodos, pero su medida de intermediaciÃ³n es heterogÃ©nea.</p>
<p>En promedio, los nodos estÃ¡n alrededor de nodos que son importantes en la red y cada uno dista, en promedio, 0.22 de la medida, lo que los hace homogÃ©neos.</p>
<p><strong>Grafo 2</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">graph_from_literal</span>(<span class="dv">1-2</span>, <span class="dv">2-3</span>, <span class="dv">3-4</span>, <span class="dv">3-5</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g2, <span class="at">vertex.size=</span><span class="dv">45</span>, <span class="at">vertex.color=</span><span class="st">"gray"</span>, <span class="at">edge.color=</span><span class="st">"gray"</span>, <span class="at">vertex.label.cex=</span><span class="dv">1</span>, <span class="at">vertex.label.color=</span><span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>ResumÃ©n de vÃ©rtices y de grafo</em></p>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>G2 <span class="ot">=</span> <span class="fu">fun7</span>(g2)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen vertice </span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ResV <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">Grado =</span> G2<span class="sc">$</span>Grado, <span class="at">Cernacia =</span> <span class="fu">round</span>(G2<span class="sc">$</span>Cercania, <span class="dv">2</span>), <span class="at">Intermediacion =</span> <span class="fu">round</span>(G2<span class="sc">$</span>Intermediacion, <span class="dv">2</span>), <span class="at">Propia =</span> <span class="fu">round</span>(G2<span class="sc">$</span>Propia, <span class="dv">2</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>ResV <span class="ot">&lt;-</span> ResV[, <span class="fu">order</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(ResV)))]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ResV, <span class="at">align=</span><span class="st">"c"</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen grafo</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(G2<span class="sc">$</span>Tabla, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Grado</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">3.00</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cernacia</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">0.80</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Intermediacion</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.83</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Propia</td>
<td style="text-align: center;">0.41</td>
<td style="text-align: center;">0.77</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">0.54</td>
<td style="text-align: center;">0.54</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Medida</th>
<th style="text-align: center;">Grado</th>
<th style="text-align: center;">Cercania</th>
<th style="text-align: center;">Intermediacion</th>
<th style="text-align: center;">Propia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Media</td>
<td style="text-align: center;">1.60</td>
<td style="text-align: center;">0.58</td>
<td style="text-align: center;">0.27</td>
<td style="text-align: center;">0.65</td>
</tr>
<tr class="even">
<td style="text-align: center;">Desviacion estÃ¡ndar</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">0.15</td>
<td style="text-align: center;">0.38</td>
<td style="text-align: center;">0.23</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>SegÃºn la tabla de resumen del grafo, cada nodo tiene en promedio 1 relaciÃ³n con otro nodo, pero la desviaciÃ³n estÃ¡ndar indica que hay variabilidad de aproximademante una relaciÃ³n entre estos y la media.</p>
<p>En promedio, cada nodo es moderadamente cercano a los otros y cada uno dista, en promedio, 0.15 de la medida de cercanÃ­a, lo que los hace homogÃ©neos.</p>
<p>En promedio, los nodos tienden a no estar entre otros pares de nodos, pero su medida de intermediaciÃ³n es heterogÃ©nea, por lo que algunos pueden si estarlo.</p>
<p>En promedio, los nodos estÃ¡n alrededor de nodos que son importantes en la red y cada uno dista, en promedio, 0.23 de la medida, lo que los hace homogÃ©neos.</p>
<p><strong>Grafo 3</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">graph_from_literal</span>(<span class="dv">1-2</span>, <span class="dv">2-3</span>, <span class="dv">3-4</span>, <span class="dv">4-5</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g3, <span class="at">vertex.size=</span><span class="dv">45</span>, <span class="at">vertex.color=</span><span class="st">"gray"</span>, <span class="at">edge.color=</span><span class="st">"gray"</span>, <span class="at">vertex.label.cex=</span><span class="dv">1</span>, <span class="at">vertex.label.color=</span><span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>ResumÃ©n de vÃ©rtices y de grafo</em></p>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>G3 <span class="ot">=</span> <span class="fu">fun7</span>(g3)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen vertice </span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ResV <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">Grado =</span> G3<span class="sc">$</span>Grado, <span class="at">Cernacia =</span> <span class="fu">round</span>(G3<span class="sc">$</span>Cercania, <span class="dv">2</span>), <span class="at">Intermediacion =</span> <span class="fu">round</span>(G3<span class="sc">$</span>Intermediacion, <span class="dv">2</span>), <span class="at">Propia =</span> <span class="fu">round</span>(G3<span class="sc">$</span>Propia, <span class="dv">2</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>ResV <span class="ot">&lt;-</span> ResV[, <span class="fu">order</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(ResV)))]</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ResV, <span class="at">align=</span><span class="st">"c"</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen grafo</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(G3<span class="sc">$</span>Tabla, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Grado</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cernacia</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Intermediacion</td>
<td style="text-align: center;">0.0</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Propia</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.87</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">0.87</td>
<td style="text-align: center;">0.5</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Medida</th>
<th style="text-align: center;">Grado</th>
<th style="text-align: center;">Cercania</th>
<th style="text-align: center;">Intermediacion</th>
<th style="text-align: center;">Propia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Media</td>
<td style="text-align: center;">1.60</td>
<td style="text-align: center;">0.52</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: center;">Desviacion estÃ¡ndar</td>
<td style="text-align: center;">0.55</td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;">0.31</td>
<td style="text-align: center;">0.23</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>SegÃºn la tabla de resumen del grafo, cada nodo tiene en promedio 1 relaciÃ³n con otro nodo, pero la desviaciÃ³n estÃ¡ndar indica que hay variabilidad de aproximademante una relaciÃ³n entre estos y la media.</p>
<p>En promedio, cada nodo es moderadamente cercano a los otros y cada uno dista, en promedio, 0.12 de la medida de cercanÃ­a, lo que los hace homogÃ©neos.</p>
<p>En promedio, los nodos tienden a estar moderadamente entre otros pares de nodos y su medida de intermediaciÃ³n es heterogÃ©nea, por lo que algunos nodos pueden tener una medida alta.</p>
<p>En promedio, los nodos tienden a estar alrededor de nodos que son importantes en la red y cada uno dista, en promedio, 0.23 de la medida, lo que los hace homogÃ©neos.</p>
<p><strong>Grafo 4</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">graph_from_literal</span>(<span class="dv">1-2</span>, <span class="dv">2-3</span>, <span class="dv">3-4</span>, <span class="dv">4-5</span>, <span class="dv">5-1</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g4, <span class="at">vertex.size=</span><span class="dv">45</span>, <span class="at">vertex.color=</span><span class="st">"gray"</span>, <span class="at">edge.color=</span><span class="st">"gray"</span>, <span class="at">vertex.label.cex=</span><span class="dv">1</span>, <span class="at">vertex.label.color=</span><span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>ResumÃ©n de vÃ©rtices y de grafo</em></p>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>G4 <span class="ot">=</span> <span class="fu">fun7</span>(g4)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen vertice </span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>ResV <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">Grado =</span> G4<span class="sc">$</span>Grado, <span class="at">Cernacia =</span> <span class="fu">round</span>(G4<span class="sc">$</span>Cercania, <span class="dv">2</span>), <span class="at">Intermediacion =</span> <span class="fu">round</span>(G4<span class="sc">$</span>Intermediacion, <span class="dv">2</span>), <span class="at">Propia =</span> <span class="fu">round</span>(G4<span class="sc">$</span>Propia, <span class="dv">2</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ResV <span class="ot">&lt;-</span> ResV[, <span class="fu">order</span>(<span class="fu">as.numeric</span>(<span class="fu">colnames</span>(ResV)))]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ResV, <span class="at">align=</span><span class="st">"c"</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen grafo</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(G4<span class="sc">$</span>Tabla, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Grado</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">2.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cernacia</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">0.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Intermediacion</td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;">0.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Propia</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">1.00</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Medida</th>
<th style="text-align: center;">Grado</th>
<th style="text-align: center;">Cercania</th>
<th style="text-align: center;">Intermediacion</th>
<th style="text-align: center;">Propia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Media</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Desviacion estÃ¡ndar</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>SegÃºn la tabla de resumen del grafo, cada nodo tiene 2 relaciones con otros nodos.</p>
<p>Cada nodo es moderadamente cercano a los otros y todos tienen la misma medida de cercanÃ­a.</p>
<p>Los nodos no tienden a estar entre otros pares de nodos y todos tienen la misma medida de intermediaciÃ³n.</p>
<p>Todos los nodos estÃ¡n alrededor de nodos que son importantes en la red.</p>
<p>En general, el grafo que presenta la cualidad de tener nodos que esten alrededor de nodos importantes es el Ãºltimo. AdemÃ¡s, tambiÃ©n es el grafo que tiene mÃ¡s nodos cercanos de otros.</p>
</section>
<section id="punto-8" class="level2">
<h2 class="anchored" data-anchor-id="punto-8">Punto 8</h2>
<p>Considere los datos relacionales acerca de los conflictos internacionales del archivo <code>conflict.RData</code> despÃºes de simetrizarla dÃ©bilmente y remover los nodos aislados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"conflict.RData"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>g8 <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(dat<span class="sc">$</span>Y, <span class="at">mode =</span> <span class="st">"directed"</span>, <span class="at">weighted =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simetrizacion debil</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>g8 <span class="ot">&lt;-</span> <span class="fu">as_undirected</span>(g8, <span class="at">mode =</span> <span class="st">"collapse"</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">is_directed</span>(g8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g8)<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dat<span class="sc">$</span>X)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g8)<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(<span class="fu">vcount</span>(g8) <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># IDs numÃ©ricos empezando en 0</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g8)<span class="sc">$</span>nodesize <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g8)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g8)<span class="sc">$</span>polity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>X[,<span class="dv">3</span>] <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"polity &gt; 0"</span>, <span class="st">"polity &lt; 0"</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remover nodos aislados </span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>g8 <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">delete_vertices</span>(g8, <span class="fu">which</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(g8) <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(g8))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4  5  6  7  8 14 27 29 
29 16 15 13  4  7  2  2  1  1  1 </code></pre>
</div>
</div>
<p><strong>a. Hacer una visualizaciÃ³n de la red.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactivo</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> <span class="fu">as_data_frame</span>(g8, <span class="at">what =</span> <span class="st">"edges"</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>source_id <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>from, <span class="fu">V</span>(g8)<span class="sc">$</span>name) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>links<span class="sc">$</span>target_id <span class="ot">&lt;-</span> <span class="fu">match</span>(links<span class="sc">$</span>to, <span class="fu">V</span>(g8)<span class="sc">$</span>name) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">V</span>(g8)<span class="sc">$</span>name)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">V</span>(g8)<span class="sc">$</span>id  <span class="co"># IDs numÃ©ricos empezando en 0</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>nodesize <span class="ot">&lt;-</span> <span class="fu">V</span>(g8)<span class="sc">$</span>nodesize</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>polity <span class="ot">&lt;-</span> <span class="fu">V</span>(g8)<span class="sc">$</span>polity</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Teniendo en cuenta el grado</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="fu">forceNetwork</span>(<span class="at">Links =</span> links, <span class="at">Nodes =</span> nodes,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">Source =</span> <span class="st">"source_id"</span>, <span class="at">Target =</span> <span class="st">"target_id"</span>, <span class="at">linkColour =</span> <span class="st">"gray"</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">NodeID =</span> <span class="st">"name"</span>, <span class="at">Group =</span> <span class="st">"polity"</span>, <span class="at">Nodesize =</span> <span class="st">"nodesize"</span>,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">radiusCalculation=</span><span class="st">"Math.sqrt(d.nodesize)*3"</span>, <span class="at">fontSize =</span> <span class="dv">20</span>,  <span class="at">legend=</span><span class="cn">TRUE</span>,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">opacity =</span> <span class="fl">0.9</span>, <span class="at">colourScale =</span> <span class="fu">JS</span>(<span class="st">"d3.scaleOrdinal(d3.schemeCategory10);"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="forceNetwork html-widget html-fill-item" id="htmlwidget-aa2b24325184a515a37a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-aa2b24325184a515a37a">{"x":{"links":{"source":[2,2,6,19,1,14,3,12,23,26,8,4,17,0,25,3,4,5,6,8,12,25,26,29,36,37,37,3,4,5,6,8,12,25,26,29,37,38,39,17,37,14,30,15,17,37,40,8,9,18,20,33,7,13,14,15,43,15,37,40,48,32,37,40,37,40,34,37,40,17,34,35,4,12,17,26,41,37,40,17,41,62,2,15,24,53,44,33,54,37,40,63,28,37,40,46,27,30,37,40,43,55,47,12,37,40,34,25,52,37,38,40,17,41,60,10,11,51,27,22,29,36,37,40,76,36,37,40,2,15,24,42,53,65,74,16,32,37,40,0,12,17,21,32,36,37,40,43,45,62,74,76,18,31,81,86,68,24,65,84],"target":[19,24,24,24,29,30,32,32,32,32,34,35,35,36,36,37,37,37,37,37,37,37,37,37,37,38,39,40,40,40,40,40,40,40,40,40,40,40,40,41,41,43,43,45,49,50,50,51,53,54,54,54,55,55,55,55,55,56,56,56,56,57,57,57,58,58,59,59,59,60,61,61,62,62,62,62,62,63,63,64,64,64,65,65,65,65,66,67,67,68,68,68,69,69,69,69,70,70,70,70,70,70,71,72,72,72,73,74,75,76,76,76,77,77,77,78,79,79,80,82,82,82,82,82,82,83,83,83,84,84,84,84,84,84,84,85,85,85,85,86,86,86,86,86,86,86,86,86,86,86,86,86,87,87,87,87,88,89,90,90],"colour":["gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray"]},"nodes":{"name":["AFG","ALB","ANG","ARG","AUL","BAH","BEL","BEN","BNG","BOT","BUI","CAM","CAN","CAO","CDI","CHA","CHL","CHN","COL","CON","COS","CUB","CYP","DOM","DRC","EGY","FRN","GHA","GNB","GRC","GUI","GUY","HAI","HON","IND","INS","IRN","IRQ","ISR","ITA","JOR","JPN","KEN","LBR","LES","LIB","MAA","MAL","MLI","MON","MOR","MYA","MZM","NAM","NIC","NIG","NIR","NTH","OMA","PAK","PHI","PNG","PRK","QAT","ROK","RWA","SAF","SAL","SAU","SEN","SIE","SIN","SPN","SRI","SUD","SWA","SYR","TAW","TAZ","THI","TOG","TRI","TUR","UAE","UGA","UKG","USA","VEN","YEM","ZAM","ZIM"],"group":["polity < 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity < 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity < 0","polity > 0","polity < 0","polity > 0","polity < 0","polity > 0","polity > 0","polity < 0","polity < 0","polity > 0","polity > 0","polity > 0","polity < 0","polity > 0","polity < 0"],"nodesize":[2,1,4,3,4,2,3,1,4,1,1,1,6,1,3,5,1,8,2,2,1,1,1,1,6,4,4,2,1,4,3,1,7,2,4,3,6,29,3,2,27,5,1,5,1,2,1,1,1,1,2,2,1,3,4,6,4,3,2,3,2,2,7,3,3,6,1,2,4,4,6,1,3,1,3,1,5,3,1,2,1,1,6,3,8,4,14,4,1,1,2]},"options":{"NodeID":"name","Group":"polity","colourScale":"d3.scaleOrdinal(d3.schemeCategory10);","fontSize":20,"fontFamily":"serif","clickTextSize":50,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-30,"opacity":0.9,"zoom":false,"legend":true,"arrows":false,"nodesize":true,"radiusCalculation":"Math.sqrt(d.nodesize)*3","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>b. Caracterizar local y estructuralmente la red, en tÃ©rminos de la distancia, la centralidad, la cohesiÃ³n, la conectivaidad, y el agrupamento. Utilizar todas las mÃ©tricas disponbles. C. Interpretar los resultados</strong></p>
<p><strong>Distancia</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de Distancias </span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">distances</span>(<span class="at">graph =</span> g8, <span class="at">v =</span> <span class="fu">V</span>(g8), <span class="at">to =</span> <span class="fu">V</span>(g8))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># DiÃ¡metro </span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La distancia mÃ¡s larga entre los paÃ­ses del grafo es de:"</span> , <span class="fu">diameter</span>(g8), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La distancia mÃ¡s larga entre los paÃ­ses del grafo es de: 18 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sendero del diametro </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">get_diameter</span>(g8)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Los paÃ­ses que se deben recorrer en el sendero del diametro son:"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Los paÃ­ses que se deben recorrer en el sendero del diametro son: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 11/91 vertices, named, from 33866a5:
 [1] CAM THI MYA BNG JOR USA VEN COL NIC SAL HON</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VisualizaciÃ³n del diÃ¡metro </span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g8)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"white"</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g8)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g8)<span class="sc">$</span>width <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g8)[d]<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g8, <span class="at">path =</span> d)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g8, <span class="at">path =</span> d)<span class="sc">$</span>width <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g8, <span class="at">vertex.label=</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distancia geodÃ©sica promedio</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resumen, <span class="fu">round</span>(<span class="fu">mean_distance</span>(g8),<span class="dv">3</span>))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(resumen)  <span class="ot">&lt;-</span> <span class="st">"Grafo"</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La distancia geodÃ©sica promedio es de"</span>, <span class="fu">round</span>(<span class="fu">mean_distance</span>(g8),<span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La distancia geodÃ©sica promedio es de 5.072 </code></pre>
</div>
</div>
<p>En promedio, cada paÃ­s estÃ¡ separado de los demÃ¡s en 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DistribuciÃ³n de las distancias </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>senderos <span class="ot">&lt;-</span> <span class="fu">distance_table</span>(g8)<span class="sc">$</span>res</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(senderos) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(senderos)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">prop.table</span>(senderos), <span class="at">xlab =</span> <span class="st">"Distancia geodÃ©sica"</span>, <span class="at">ylab =</span> <span class="st">"F. Relativa"</span>, <span class="at">border =</span> <span class="st">"grey"</span>, <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">main =</span> <span class="st">"DistribuciÃ³n de distancias geodÃ©sicas"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>De acuerdo al grÃ¡fico, la distribuciÃ³n de las distancias entre los paÃ­ses se acumula en un rango de 1 a 7</p>
<p><strong>Centralidad</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grado de cada vertice</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g8, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(d, <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IRQ JOR USA CHN UGA 
 29  27  14   8   8 </code></pre>
</div>
</div>
<p>Los paÃ­ses que mÃ¡s se han relacionado con diferentes paÃ­ses en relaciones de conflicto son IRAQ y JORDANIA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resumen,  <span class="fu">round</span>(<span class="fu">mean</span>(d),<span class="dv">3</span>))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"El grado promedio del grafo es de:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(d),<span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>El grado promedio del grafo es de: 3.52 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La desviaciÃ³n del grado es de:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(d),<span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La desviaciÃ³n del grado es de: 4.29 </code></pre>
</div>
</div>
<p>En promedio, cada paÃ­s estÃ¡ involucrado en relaciones de conflicto con tres paises, pero los grados de los nodos tienden a ser heterogeneos segÃºn la desviaciÃ³n estÃ¡ndar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DistribuciÃ³n del grado</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">degree_distribution</span>(g8)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co">#VisualizaciÃ³n</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="at">xlab =</span> <span class="st">"Grado"</span>, <span class="at">ylab =</span> <span class="st">"Densidad"</span>, <span class="at">main =</span> <span class="st">"DistribuciÃ³n de grado"</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(d, <span class="at">freq =</span> F, <span class="at">col =</span> <span class="st">"cyan"</span>, <span class="at">border =</span> <span class="st">"royalblue"</span>, <span class="at">add =</span> T)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((<span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(d))[dd <span class="sc">!=</span> <span class="dv">0</span>], dd[dd <span class="sc">!=</span> <span class="dv">0</span>], <span class="at">log =</span> <span class="st">"xy"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"royalblue"</span>, <span class="fl">0.5</span>), <span class="at">xlab =</span> <span class="st">"Log-grado"</span>, <span class="at">ylab =</span> <span class="st">"Log-densidad"</span>, <span class="at">main =</span> <span class="st">"DistribuciÃ³n de grado (log-log)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La distribuciÃ³n del grado es sesgada a la derecha, por lo que la mayorÃ­a de paÃ­ses tienen relaciones de conflicto con menos de 5 paÃ­ses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fuerza de cada vertice</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> <span class="fu">strength</span>(g8)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(wd, <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IRQ USA JOR TUR PRK 
 70  31  27  27  23 </code></pre>
</div>
</div>
<p>Los paÃ­ses que mayor cantidad de conflictos tienen son IRAQ y USA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resumen, <span class="fu">round</span>(<span class="fu">mean</span>(wd),<span class="dv">2</span>))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La fuerza promedio del grafo es de:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(wd),<span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La fuerza promedio del grafo es de: 6.7 </code></pre>
</div>
</div>
<p>En promedio, los paÃ­ses tienen 7 relaciones de conflicto con los demÃ¡s paÃ­ses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grado promedio de los vecinos  mÃ¡s cercados de orden 1</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>mnd <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">graph =</span> g8, <span class="at">vids =</span> <span class="fu">V</span>(g8))<span class="sc">$</span>knn</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"El grado promedio de los vecinos  mÃ¡s cercados de orden 1 es de:"</span>, <span class="fu">mean</span>(d[<span class="fu">as.numeric</span>(<span class="fu">neighbors</span>(<span class="at">graph =</span> g8, <span class="at">v =</span> <span class="dv">1</span>))]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>El grado promedio de los vecinos  mÃ¡s cercados de orden 1 es de: 10</code></pre>
</div>
</div>
<p>En promedio, los paÃ­ses que estÃ¡n directamente conectados con otro paÃ­s, tienen relaciones de conflicto con 10 paÃ­ses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CercanÃ­a</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>clss <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">closeness</span>(g8, <span class="at">normalized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(clss, <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAL MZM SIN SWA LES 
1.0 1.0 1.0 1.0 0.5 </code></pre>
</div>
</div>
<p>Los paÃ­ses mÃ¡s cercanos a otros paÃ­ses son Malasia, Mozambique, Singapur y Suazilandia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resumen, <span class="fu">round</span>(<span class="fu">mean</span>(clss), <span class="dv">3</span>))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La cercanÃ­a promedio del grafo es de: "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(clss), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La cercanÃ­a promedio del grafo es de:  0.26 </code></pre>
</div>
</div>
<p>En promedio, los paÃ­ses en la red de conflictos no presentan tanta cercanÃ­a unos entre otros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IntermediaciÃ³n </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>btw <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(g8, <span class="at">normalized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(btw, <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      JOR       USA       IRQ       VEN       CHA 
0.4811380 0.2441667 0.1539473 0.1338327 0.1292385 </code></pre>
</div>
</div>
<p>El paÃ­s JORDANIA es un paÃ­s moderadamente importante en la red, pues se encuentra en las relaciones de conflicto entre otros pares de paÃ­ses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resumen, <span class="fu">round</span>(<span class="fu">mean</span>(btw), <span class="dv">3</span>))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La intermediaciÃ³n promedio del grafo es de: "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(btw), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La intermediaciÃ³n promedio del grafo es de:  0.03 </code></pre>
</div>
</div>
<p>En promedio, los paÃ­ses de la red no estÃ¡n ubicados entre las relaciones de conflicto de los demÃ¡s paÃ­ses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Centralidad propia </span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">eigen_centrality</span>(g8)<span class="sc">$</span>vector</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(ev, <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      IRQ       TUR       USA       IRN       GRC 
1.0000000 0.6101628 0.6036670 0.4512958 0.3660738 </code></pre>
</div>
</div>
<p>Los paÃ­ses que tienen relaciones de conflicto con mÃ¡s paÃ­ses centrales son IRAQ, TURQUIA y USA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resumen, <span class="fu">round</span>(<span class="fu">mean</span>(ev), <span class="dv">3</span>))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La centralidad propia promedio del grafo es de: "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(ev), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La centralidad propia promedio del grafo es de:  0.08 </code></pre>
</div>
</div>
<p>En promedio, los paÃ­ses no tienen relaciones de conflicto con paÃ­ses centrales.</p>
<p><strong>CohesiÃ³n</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clan</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">sapply</span>(<span class="at">X =</span> <span class="fu">cliques</span>(<span class="at">graph =</span> g8, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">10</span>), <span class="at">FUN =</span> length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4 
 91 160  67   9 </code></pre>
</div>
</div>
<p>En la red hay 67 triadas que conforman un grafo completo y 9 cliques de tamaÃ±o 4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clanes mÃ¡ximos </span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">largest_cliques</span>(<span class="at">graph =</span> g8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
+ 4/91 vertices, named, from 33866a5:
[1] TUR IRQ JOR GRC

[[2]]
+ 4/91 vertices, named, from 33866a5:
[1] TUR IRQ JOR SYR

[[3]]
+ 4/91 vertices, named, from 33866a5:
[1] UGA RWA DRC ANG

[[4]]
+ 4/91 vertices, named, from 33866a5:
[1] PRK CHN ROK JPN

[[5]]
+ 4/91 vertices, named, from 33866a5:
[1] QAT IRQ SAU JOR

[[6]]
+ 4/91 vertices, named, from 33866a5:
[1] USA IRQ JOR CAN

[[7]]
+ 4/91 vertices, named, from 33866a5:
[1] USA IRQ JOR SYR

[[8]]
+ 4/91 vertices, named, from 33866a5:
[1] SPN CAN JOR IRQ

[[9]]
+ 4/91 vertices, named, from 33866a5:
[1] SYR IRQ JOR ISR</code></pre>
</div>
</div>
<p>Hay 9 clanes mÃ¡ximos. Es posible observar que IRAQ estÃ¡ presente en la mayorÃ­a de estos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clan mÃ¡ximo </span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">clique_num</span>(<span class="at">graph =</span> g8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resumen, <span class="fu">clique_num</span>(<span class="at">graph =</span> g8))</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"El tamaÃ±o del clan mÃ¡ximo es de 4 paÃ­ses </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>El tamaÃ±o del clan mÃ¡ximo es de 4 paÃ­ses </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Densidad </span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>dens <span class="ot">&lt;-</span> <span class="fu">edge_density</span>(g8)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resumen, <span class="fu">round</span>(dens, <span class="dv">3</span>))</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La densidad del grafo es de: "</span>, <span class="fu">round</span>(dens,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La densidad del grafo es de:  0.04</code></pre>
</div>
</div>
<p>Dado que la densidad de la red es de 0.04, la red estÃ¡ muy alejada de que todos los paÃ­ses tengan relaciones de conflicto con todos los demÃ¡s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transitividad global</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># NÃºmero de triÃ¡ngulos por vÃ©rtice</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(<span class="fu">count_triangles</span>(<span class="at">graph =</span> g8), <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 37 33 10  7  7</code></pre>
</div>
</div>
<p>Hay 2 paÃ­ses que estÃ¡n en mÃ¡s de 30 triangulos en la red.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>tr <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(<span class="at">graph =</span> g8, <span class="at">type =</span> <span class="st">"global"</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> <span class="fu">rbind</span>(resumen, <span class="fu">round</span>(tr, <span class="dv">3</span>))</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"La transitividad del grafo es de: "</span>, <span class="fu">round</span>(tr,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>La transitividad del grafo es de:  0.16</code></pre>
</div>
</div>
<p>Existe baja propensiÃ³n de que las triplas de la red de conflictos formen triÃ¡ngulos, pues la cuantificaciÃ³n del coeficiente de agrupamiento es de 0.16.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transitividad local </span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(<span class="fu">transitivity</span>(<span class="at">graph =</span> g8, <span class="at">type =</span> <span class="st">"local"</span>), <span class="at">decreasing =</span> T), <span class="at">n =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AFG BAH CON HON ISR ITA MOR OMA PHI QAT ROK SAL SPN ZIM SYR 
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.7 </code></pre>
</div>
</div>
<p>De acuerdo a esto, hay al menos 10 paÃ­ses que tienen paÃ­ses vecinos propensos a ser clanes.</p>
<p><strong>Conectividad</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"El grafo estÃ¡ conectado debilmente: "</span>, <span class="fu">is_connected</span>(<span class="at">graph =</span> g8, <span class="at">mode =</span> <span class="st">"weak"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>El grafo estÃ¡ conectado debilmente:  FALSE </code></pre>
</div>
</div>
<p>Todos los paÃ­ses no son accesibles desde todos los demÃ¡s en esta red de conflictos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#k-conectividad</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vertex_connectivity</span>(g8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Si se remueve un vÃ©rtice, el grafo restante no es conectado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arista-conectividad</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_connectivity</span>(g8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Si se remueve una relaciÃ³n, el grafo restante no es conectado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># puntos de articulaciÃ³n</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">articulation_points</span>(g8), <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 5/91 vertices, named, from 33866a5:
[1] USA GHA SIE NIG NIR</code></pre>
</div>
</div>
<p>Si se remueve algÃºn paÃ­s como USA o NIGERIA, el grafo queda desconectado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>componentes <span class="ot">&lt;-</span> <span class="fu">decompose</span>(g8)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Hay "</span>, <span class="fu">length</span>(componentes), <span class="st">"componentes conectadas en el grafo </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hay  5 componentes conectadas en el grafo </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tamaÃ±o de la componte gigante</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">sapply</span>(<span class="at">X =</span> componentes, <span class="at">FUN =</span> vcount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 2 83 
 4  1 </code></pre>
</div>
</div>
<p>Cuatro componentes tienen dos paÃ­ses y la componente gigante tiene 83.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">sapply</span>(<span class="at">X =</span> componentes, <span class="at">FUN =</span> vcount))<span class="sc">/</span><span class="fu">vcount</span>(g8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9120879</code></pre>
</div>
</div>
<p>La componente gigante tiene el 91 % de los paÃ­ses de la red.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># componente gigante</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>g8_gc <span class="ot">&lt;-</span> <span class="fu">decompose</span>(g8)[[<span class="dv">1</span>]]</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># vÃ©rtice-conectividad</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vertex_connectivity</span>(g8_gc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arista-conectividad</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_connectivity</span>(g8_gc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>Se requiere la eliminaciÃ³n de un solo paÃ­s o una sola relaciÃ³n para dividir el componente gigante en componentes adicionales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># puntos de articulaciÃ³n</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>g8_cv <span class="ot">&lt;-</span> <span class="fu">articulation_points</span>(g8_gc)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(g8_cv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22</code></pre>
</div>
</div>
<p>Hay 22 paÃ­ses que hacen parte de la componente gigante, que al removerlos, desconectarÃ­an el grafo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proporcion nodos</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">length</span>(g8_cv)<span class="sc">/</span><span class="fu">vcount</span>(g8_gc),<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.27</code></pre>
</div>
</div>
<p>Lo que corresponde al 27% de los paÃ­ses de la componente gigante.</p>
<p><strong>AgrupaciÃ³n</strong></p>
<p>Se prueban diferentes algoritmos para ser comparados con el mÃ©todo rand.</p>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Algoritmos</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">layout_nicely</span>(g8)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g8)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"gray"</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">igraph_options</span>(<span class="at">vertex.size =</span><span class="dv">18</span>)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>kc_label_prop <span class="ot">&lt;-</span> <span class="fu">cluster_label_prop</span>(g8)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g8, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">layout =</span> nc, <span class="at">vertex.color =</span> kc_label_prop<span class="sc">$</span>membership, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"label prop: "</span>, <span class="st">"Mod = "</span>, <span class="fu">round</span>(<span class="fu">modularity</span>(kc_label_prop), <span class="dv">4</span>)))</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>kc_optimal <span class="ot">&lt;-</span> <span class="fu">cluster_optimal</span>(g8)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g8, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">layout =</span> nc, <span class="at">vertex.color =</span> kc_optimal<span class="sc">$</span>membership, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"optimal: "</span>, <span class="st">"Mod = "</span>, <span class="fu">round</span>(<span class="fu">modularity</span>(kc_optimal), <span class="dv">4</span>)))</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>kc_walktrap <span class="ot">&lt;-</span> <span class="fu">cluster_walktrap</span>(g8)</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g8, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">layout =</span> nc, <span class="at">vertex.color =</span> kc_walktrap<span class="sc">$</span>membership, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"walktrap: "</span>, <span class="st">"Mod = "</span>, <span class="fu">round</span>(<span class="fu">modularity</span>(kc_walktrap), <span class="dv">4</span>)))</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>kc_louvain <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(g8)</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g8, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">layout =</span> nc, <span class="at">vertex.color =</span> kc_louvain<span class="sc">$</span>membership, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"louvain: "</span>, <span class="st">"Mod = "</span>, <span class="fu">round</span>(<span class="fu">modularity</span>(kc_louvain), <span class="dv">4</span>)))</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>kc_infomap <span class="ot">&lt;-</span> <span class="fu">cluster_infomap</span>(g8)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g8, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">layout =</span> nc, <span class="at">vertex.color =</span> kc_infomap<span class="sc">$</span>membership, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"infomap: "</span>, <span class="st">"Mod = "</span>, <span class="fu">round</span>(<span class="fu">modularity</span>(kc_infomap), <span class="dv">4</span>)))</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>kc_edge <span class="ot">&lt;-</span> <span class="fu">cluster_edge_betweenness</span>(g8)</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g8, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">layout =</span> nc, <span class="at">vertex.color =</span> kc_edge<span class="sc">$</span>membership, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"edge betweennness: "</span>, <span class="st">"Mod = "</span>, <span class="fu">round</span>(<span class="fu">modularity</span>(kc_edge), <span class="dv">4</span>)))</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>kc_fast_greedy <span class="ot">&lt;-</span> <span class="fu">cluster_fast_greedy</span>(g8)</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g8, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">layout =</span> nc, <span class="at">vertex.color =</span> kc_fast_greedy<span class="sc">$</span>membership, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"fast greedy: "</span>, <span class="st">"Mod = "</span>, <span class="fu">round</span>(<span class="fu">modularity</span>(kc_fast_greedy), <span class="dv">4</span>)))</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>kc_leading_eigen <span class="ot">&lt;-</span> <span class="fu">cluster_leading_eigen</span>(g8)</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g8, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">layout =</span> nc, <span class="at">vertex.color =</span> kc_leading_eigen<span class="sc">$</span>membership, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"leading eigen: "</span>, <span class="st">"Mod = "</span>, <span class="fu">round</span>(<span class="fu">modularity</span>(kc_leading_eigen), <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-67-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-67-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-67-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-67-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-67-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-67-7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-67-8.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-fig-pos="H"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparaciÃ³n usando el Ã­ndice de rand</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>algoritmos <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fast_greedy =</span> kc_fast_greedy<span class="sc">$</span>membership,</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">leading_eigen =</span> kc_leading_eigen<span class="sc">$</span>membership,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">walktrap =</span> kc_walktrap<span class="sc">$</span>membership,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">louvain =</span> kc_louvain<span class="sc">$</span>membership,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">label_prop =</span> kc_label_prop<span class="sc">$</span>membership,</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">optimal =</span> kc_optimal<span class="sc">$</span>membership,</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">infomap =</span> kc_infomap<span class="sc">$</span>membership,</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">edge_betweenness =</span> kc_edge<span class="sc">$</span>membership</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">metodo1 =</span> <span class="fu">names</span>(algoritmos),</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">metodo2 =</span> <span class="fu">names</span>(algoritmos),</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar el Ãndice de Rand</span></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>comp<span class="sc">$</span>rand <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="cf">function</span>(m1, m2) {</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compare</span>(algoritmos[[m1]], algoritmos[[m2]], <span class="at">method =</span> <span class="st">"rand"</span>)</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>}, comp<span class="sc">$</span>metodo1, comp<span class="sc">$</span>metodo2)</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados como matriz</span></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>matriz <span class="ot">&lt;-</span> <span class="fu">with</span>(comp, <span class="fu">tapply</span>(rand, <span class="fu">list</span>(metodo1, metodo2), mean))</span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(matriz, <span class="dv">3</span>), <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">edge_betweenness</th>
<th style="text-align: center;">fast_greedy</th>
<th style="text-align: center;">infomap</th>
<th style="text-align: center;">label_prop</th>
<th style="text-align: center;">leading_eigen</th>
<th style="text-align: center;">louvain</th>
<th style="text-align: center;">optimal</th>
<th style="text-align: center;">walktrap</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">edge_betweenness</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.915</td>
<td style="text-align: center;">0.905</td>
<td style="text-align: center;">0.925</td>
<td style="text-align: center;">0.877</td>
<td style="text-align: center;">0.915</td>
<td style="text-align: center;">0.918</td>
<td style="text-align: center;">0.873</td>
</tr>
<tr class="even">
<td style="text-align: left;">fast_greedy</td>
<td style="text-align: center;">0.915</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.956</td>
<td style="text-align: center;">0.938</td>
<td style="text-align: center;">0.874</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.996</td>
<td style="text-align: center;">0.910</td>
</tr>
<tr class="odd">
<td style="text-align: left;">infomap</td>
<td style="text-align: center;">0.905</td>
<td style="text-align: center;">0.956</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.942</td>
<td style="text-align: center;">0.869</td>
<td style="text-align: center;">0.956</td>
<td style="text-align: center;">0.955</td>
<td style="text-align: center;">0.913</td>
</tr>
<tr class="even">
<td style="text-align: left;">label_prop</td>
<td style="text-align: center;">0.925</td>
<td style="text-align: center;">0.938</td>
<td style="text-align: center;">0.942</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.873</td>
<td style="text-align: center;">0.938</td>
<td style="text-align: center;">0.938</td>
<td style="text-align: center;">0.910</td>
</tr>
<tr class="odd">
<td style="text-align: left;">leading_eigen</td>
<td style="text-align: center;">0.877</td>
<td style="text-align: center;">0.874</td>
<td style="text-align: center;">0.869</td>
<td style="text-align: center;">0.873</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.874</td>
<td style="text-align: center;">0.876</td>
<td style="text-align: center;">0.894</td>
</tr>
<tr class="even">
<td style="text-align: left;">louvain</td>
<td style="text-align: center;">0.915</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.956</td>
<td style="text-align: center;">0.938</td>
<td style="text-align: center;">0.874</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.996</td>
<td style="text-align: center;">0.910</td>
</tr>
<tr class="odd">
<td style="text-align: left;">optimal</td>
<td style="text-align: center;">0.918</td>
<td style="text-align: center;">0.996</td>
<td style="text-align: center;">0.955</td>
<td style="text-align: center;">0.938</td>
<td style="text-align: center;">0.876</td>
<td style="text-align: center;">0.996</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.913</td>
</tr>
<tr class="even">
<td style="text-align: left;">walktrap</td>
<td style="text-align: center;">0.873</td>
<td style="text-align: center;">0.910</td>
<td style="text-align: center;">0.913</td>
<td style="text-align: center;">0.910</td>
<td style="text-align: center;">0.894</td>
<td style="text-align: center;">0.910</td>
<td style="text-align: center;">0.913</td>
<td style="text-align: center;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Dado que los Ã­ndices de Rand entre las agrupaciones superan el 0.8, las particiones generadas por los algoritmos son bastante similares, lo que indica que las segmentaciones de nodos no presentan variaciones significativas entre ellos.</p>
<p><strong>Resumen de medidas estructurales</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(resumen) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Distancia media"</span>, <span class="st">"Grado medio"</span>, <span class="st">"Fuerza media"</span>, <span class="st">"CercanÃ­a media"</span>, <span class="st">"IntermediaciÃ³n media"</span>, <span class="st">"CercanÃ­a propia media"</span>, <span class="st">"NÃºmero clan"</span>, <span class="st">"Densidad"</span>, <span class="st">"Transitividad"</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(resumen, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Grafo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Distancia media</td>
<td style="text-align: center;">5.072</td>
</tr>
<tr class="even">
<td style="text-align: left;">Grado medio</td>
<td style="text-align: center;">3.516</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fuerza media</td>
<td style="text-align: center;">6.700</td>
</tr>
<tr class="even">
<td style="text-align: left;">CercanÃ­a media</td>
<td style="text-align: center;">0.260</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IntermediaciÃ³n media</td>
<td style="text-align: center;">0.027</td>
</tr>
<tr class="even">
<td style="text-align: left;">CercanÃ­a propia media</td>
<td style="text-align: center;">0.082</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NÃºmero clan</td>
<td style="text-align: center;">4.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Densidad</td>
<td style="text-align: center;">0.039</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Transitividad</td>
<td style="text-align: center;">0.163</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="punto-9" class="level2">
<h2 class="anchored" data-anchor-id="punto-9">Punto 9</h2>
<p>Sintetizar y replicar los CapÃ­tulos 6, 8, y 9 de Luke, D. A. (2015).</p>
<section id="capÃ­tulo-6---graficos-avanzados-de-redes" class="level3">
<h3 class="anchored" data-anchor-id="capÃ­tulo-6---graficos-avanzados-de-redes">CapÃ­tulo 6 - Graficos avanzados de redes</h3>
<p>Aunque los paquetes statnet e igraph ofrecen funcionalidades avanzadas para la representaciÃ³n de redes, no siempre cumplen con todos los requerimientos analÃ­ticos o de presentaciÃ³n. En muchos casos, los investigadores en el campo de las redes necesitan visualizaciones mÃ¡s especializadas y dinÃ¡micas.</p>
<p><strong>GrÃ¡ficos Interactivos de Redes</strong></p>
<p>Diversos paquetes para el anÃ¡lisis de redes, como UCINet y Pajek, facilitan la creaciÃ³n de grÃ¡ficos interactivos. Aunque R proporciona un control preciso sobre las visualizaciones, no siempre incluye funcionalidades interactivas de forma nativa. Por lo que se presentan alternativas para generar grÃ¡ficos interactivos en R y publicarlos en la web.</p>
<p><strong>Redes interactivas simples con tkplot() en igraph</strong></p>
<p>El paquete igraph incluye la funciÃ³n tkplot() para grÃ¡ficos interactivos simples. Se usa para ajustar las posiciones de los nodos y luego producir un grÃ¡fico final no interactivo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Bali)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>iBali <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(Bali)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>Coord <span class="ot">&lt;-</span> <span class="fu">tkplot</span>(iBali, <span class="at">vertex.size=</span><span class="dv">3</span>,</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">vertex.label=</span><span class="fu">V</span>(iBali)<span class="sc">$</span>role,</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">vertex.color=</span><span class="st">"darkgreen"</span>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Editar el grÃ¡fico en la ventana grÃ¡fica Tk antes</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co"># de ejecutar los siguientes dos comandos.</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>MCoords <span class="ot">&lt;-</span> <span class="fu">tk_coords</span>(Coord)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iBali, <span class="at">layout=</span>MCoords, <span class="at">vertex.size=</span><span class="dv">5</span>,</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label=</span><span class="cn">NA</span>, <span class="at">vertex.color=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>PublicaciÃ³n de diagramas interactivos de redes basados en Web</strong></p>
<p>Se estÃ¡n implementando mÃ©todos para desarrollar grÃ¡ficos interactivos basados en la web utilizando frameworks como D3.js y Shiny. El paquete networkD3 permite crear visualizaciones interactivas simples que pueden integrarse en documentos de Shiny o pÃ¡ginas HTML. Por otro lado, el paquete visNetwork, basado en la biblioteca vis.js, proporciona mayores posibilidades de personalizaciÃ³n en la apariencia y facilita la incorporaciÃ³n de grÃ¡ficos en aplicaciones web desarrolladas con Shiny.</p>
<p>La funciÃ³n <em>simpleNetwork()</em> espera los datos de la red en forma de una lista de aristas almacenada en un data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(networkD3)</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>src <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>net_edge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(src, target)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="fu">simpleNetwork</span>(net_edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="forceNetwork html-widget html-fill-item" id="htmlwidget-338706642edd0e82b94a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-338706642edd0e82b94a">{"x":{"links":{"source":[0,0,1,1,2,1],"target":[1,2,2,3,1,2],"value":[1,1,1,1,1,1],"colour":["#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["A","B","C","D"],"group":[1,1,1,1],"nodesize":[8,8,8,8]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(['#3182bd'])","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":50,"linkWidth":"'1.5px'.toString()","charge":-30,"opacity":0.6,"zoom":false,"legend":false,"arrows":false,"nodesize":true,"radiusCalculation":"d.nodesize","bounded":false,"opacityNoHover":1,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Para guardar la visualizaciÃ³n:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>net_D3 <span class="ot">&lt;-</span> <span class="fu">simpleNetwork</span>(net_edge)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co"># saveNetwork(net_D3, file = 'Net_test1.html', selfcontained=TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La funciÃ³n <em>forceNetwork()</em> produce graficos mÃ¡s sofisticados.</p>
<p>Se le deben pasar los datos en dos data.frames:</p>
<ul>
<li><p>El data.frame de las aristas tendrÃ¡ los datos de red en formato de matriz de aristas.</p></li>
<li><p>El data.frame de los nodos tendrÃ¡ el ID de nodo y las propiedades de los nodos. Si los nodos tienen identificadores numÃ©ricos, deben comenzar en 0.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>iBali_edge <span class="ot">&lt;-</span> <span class="fu">as_edgelist</span>(iBali)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>iBali_edge <span class="ot">&lt;-</span> iBali_edge <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>iBali_edge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(iBali_edge)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>iBali_nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">NodeID=</span><span class="fu">as.numeric</span>(<span class="fu">V</span>(iBali)<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Group=</span><span class="fu">V</span>(iBali)<span class="sc">$</span>role,</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Nodesize=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(iBali))</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="fu">forceNetwork</span>(<span class="at">Links =</span> iBali_edge, <span class="at">Nodes =</span> iBali_nodes,</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">Source =</span> <span class="st">"X1"</span>, <span class="at">Target =</span> <span class="st">"X2"</span>,</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">NodeID =</span> <span class="st">"NodeID"</span>, <span class="at">Nodesize =</span> <span class="st">"Nodesize"</span>,</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">radiusCalculation=</span><span class="st">"Math.sqrt(d.nodesize)*3"</span>,</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">Group =</span> <span class="st">"Group"</span>, <span class="at">opacity =</span> <span class="fl">0.8</span>,</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="forceNetwork html-widget html-fill-item" id="htmlwidget-d0292fc16cdc695d412e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d0292fc16cdc695d412e">{"x":{"links":{"source":[0,0,0,0,0,0,0,0,0,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,7,7,7,7,8,8,8,9,9,9,9,10,10,10,11,11,12,14,14,15],"target":[1,2,3,4,5,7,8,14,16,3,5,6,3,4,5,7,8,14,15,16,4,5,6,7,8,9,10,11,12,13,14,16,5,7,8,14,15,16,6,7,8,14,16,8,14,15,16,14,15,16,10,11,12,13,11,12,13,12,13,13,15,16,16],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"group":["CT","OA","OA","CT","BM","CT","OA","BM","BM","SB","TL","TL","TL","TL","BM","SB","BM"],"nodesize":[9,4,9,15,9,10,3,9,9,5,5,5,5,5,9,6,9]},"options":{"NodeID":"NodeID","Group":"Group","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-30,"opacity":0.8,"zoom":false,"legend":true,"arrows":false,"nodesize":true,"radiusCalculation":"Math.sqrt(d.nodesize)*3","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Para guardar el grÃ¡fico:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>net_D3 <span class="ot">&lt;-</span> <span class="fu">forceNetwork</span>(<span class="at">Links =</span> iBali_edge,</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Nodes =</span> iBali_nodes,</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Source =</span> <span class="st">"X1"</span>, <span class="at">Target =</span> <span class="st">"X2"</span>,</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">NodeID =</span> <span class="st">"NodeID"</span>,<span class="at">Nodesize =</span> <span class="st">"Nodesize"</span>,</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">radiusCalculation=</span><span class="st">"Math.sqrt(d.Nodesize)*3"</span>,</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Group =</span> <span class="st">"Group"</span>, <span class="at">opacity =</span> <span class="fl">0.8</span>,</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend=</span><span class="cn">TRUE</span>)</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co"># saveNetwork(net_D3, file = 'Net_test2.html', selfcontained=TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Usando la funciÃ³n <em>vis.js</em> de la libreria javascript.</p>
<p>Se le deben pasar los datos en dos data.frames:</p>
<ul>
<li><p>El data.frame de las aristas tendrÃ¡ los datos de red en columnas <em>from</em> y <em>to</em>.</p></li>
<li><p>El data.frame de los nodos tendrÃ¡ el ID de nodo y las propiedades de los nodos.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(visNetwork)</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>iBali_edge <span class="ot">&lt;-</span> <span class="fu">as_edgelist</span>(iBali)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>iBali_edge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from =</span> iBali_edge[,<span class="dv">1</span>],</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">to =</span> iBali_edge[,<span class="dv">2</span>])</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>iBali_nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">as.numeric</span>(<span class="fu">V</span>(iBali)))</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(iBali_nodes, iBali_edge, <span class="at">width =</span> <span class="st">"100%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-a6651116c6d55495c9ba" style="width:100%;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-a6651116c6d55495c9ba">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]},"edges":{"from":[1,1,1,1,1,1,1,1,1,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,8,8,8,8,9,9,9,10,10,10,10,11,11,11,12,12,13,15,15,16],"to":[2,3,4,5,6,8,9,15,17,4,6,7,4,5,6,8,9,15,16,17,5,6,7,8,9,10,11,12,13,14,15,17,6,8,9,15,16,17,7,8,9,15,17,9,15,16,17,15,16,17,11,12,13,14,12,13,14,13,14,14,16,17,17]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false}},"groups":null,"width":"100%","height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Algunas opciones de la libreria son:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>iBali_nodes<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">V</span>(iBali)<span class="sc">$</span>role</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>iBali_nodes<span class="sc">$</span>value <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(iBali)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>( iBali_nodes, iBali_edge,</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">legend.width=</span><span class="cn">TRUE</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">visOptions</span>(net, <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-0dcceeb1bcd96133cfe3" style="width:100%;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-0dcceeb1bcd96133cfe3">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],"group":["CT","OA","OA","CT","BM","CT","OA","BM","BM","SB","TL","TL","TL","TL","BM","SB","BM"],"value":[9,4,9,15,9,10,3,9,9,5,5,5,5,5,9,6,9],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"]},"edges":{"from":[1,1,1,1,1,1,1,1,1,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,8,8,8,8,9,9,9,10,10,10,10,11,11,11,12,12,13,15,15,16],"to":[2,3,4,5,6,8,9,15,17,4,6,7,4,5,6,8,9,15,16,17,5,6,7,8,9,10,11,12,13,14,15,17,6,8,9,15,16,17,7,8,9,15,17,9,15,16,17,15,16,17,11,12,13,14,12,13,14,13,14,14,16,17,17]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false}},"groups":["CT","OA","BM","SB","TL"],"width":"100%","height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Las funciones <em>visNetwork()</em> y <em>visOptions()</em> establecen colores predeterminados para cada grupo y permiten que el usuario resalte los nodos individuales y sus vecinos inmediatos al hacer clic en un nodo.</p>
<p>En el ejemplo se agregan botones de navegaciÃ³n que permiten mover la red y acercar o alejar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(iBali_nodes, iBali_edge,</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">legend=</span><span class="cn">TRUE</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">visOptions</span>(net, <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">visInteraction</span>(net, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co">#library(htmlwidgets)</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co">#saveWidget(net, "Net_test3.html")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Statnet Web: Statnet Interactivo con Shiny</strong></p>
<p>Statnet Web es una aplicaciÃ³n web, basada en las herramientas de anÃ¡lisis de redes de Statnet utilizando Shiny.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(statnetWeb)</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co">#run_sw()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Diagramas de redes especializados</strong></p>
<p>Existen tÃ©cnicas especializadas para resaltar aspectos importantes de las redes, como diagramas de arco, diagramas de acordes y mapas de calor.</p>
<p><strong>Diagramas de Arco</strong></p>
<p>Los diagramas de arco se enfocan en el patrÃ³n de los enlaces mÃ¡s que en la posiciÃ³n de los nodos. Uso del paquete <em>arcdiagram</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(devtools)</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("gastonstat/arcdiagram")</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(arcdiagram)</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(UserNetR)</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Simpsons)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>iSimp <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(Simpsons)</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>simp_edge <span class="ot">&lt;-</span> <span class="fu">get.edgelist</span>(iSimp)</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="fu">arcplot</span>(simp_edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ajustando colores por subgrupos y tamaÃ±o de los nodos de acuerdo al grado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>s_grp <span class="ot">&lt;-</span> <span class="fu">V</span>(iSimp)<span class="sc">$</span>group</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>s_col <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#a6611a"</span>, <span class="st">"#dfc27d"</span>, <span class="st">"#80cdc1"</span>, <span class="st">"#018571"</span>)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">=</span> s_col[s_grp]</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>node_deg <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(iSimp)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="fu">arcplot</span>(simp_edge, <span class="at">lwd.arcs=</span><span class="dv">2</span>, <span class="at">cex.nodes=</span>node_deg<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels=</span><span class="fu">V</span>(iSimp)<span class="sc">$</span>vertex.names,</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.labels=</span><span class="st">"darkgreen"</span>, <span class="at">font=</span><span class="dv">1</span>,</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch.nodes=</span><span class="dv">21</span>, <span class="at">line=</span><span class="dv">1</span>, <span class="at">col.nodes =</span> cols,</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">bg.nodes =</span> cols, <span class="at">show.nodes =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Diagramas de Acordes</strong></p>
<p>Los diagramas de acordes usan un diseÃ±o circular para mostrar interrelaciones en una matriz. Son importantes para evaluar redes ponderadas y dirigidas.</p>
<p>Los datos se deben tener en una sociomatriz, con las entradas correspondientes al tamaÃ±o del enlace y debe tener nombres asignados a filas y a columnas. El paquete <em>circlize()</em> implementa estos grÃ¡ficos, permitiendo un gran control sobre la apariencia. Son Ãºtiles para redes valoradas y dirigidas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(statnet)</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(circlize)</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(FIFA_Nether)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>FIFAm <span class="ot">&lt;-</span> <span class="fu">as.sociomatrix</span>(FIFA_Nether, <span class="at">attrname=</span><span class="st">'passes'</span>)</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GK1"</span>, <span class="st">"DF3"</span>, <span class="st">"DF4"</span>, <span class="st">"DF5"</span>, <span class="st">"MF6"</span>,</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"FW7"</span>, <span class="st">"FW9"</span>, <span class="st">"MF10"</span>, <span class="st">"FW11"</span>, <span class="st">"DF2"</span>, <span class="st">"MF8"</span>)</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(FIFAm) <span class="ot">=</span> names</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(FIFAm) <span class="ot">=</span> names</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>FIFAm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     GK1 DF3 DF4 DF5 MF6 FW7 FW9 MF10 FW11 DF2 MF8
GK1    0  42  67  21   2  27   7    5    2  17   3
DF3   30   0  44  14  42  15   8    7   10  36  29
DF4   38  43   0  57  18  11   7   21    1   7  28
DF5    6  14  47   0  11  50  20   40    1   4  42
MF6    9  28  25  10   0  41  28   37   14  34  21
FW7    4  12   1  21  21   0  15   33    9  25  18
FW9    0   0   1   8   7  12   0   31   16   7   2
MF10   1  11  11  22  43  29  20    0   28  13  21
FW11   3   2   2   3   7   6  11   15    0  21  12
DF2   29  38   8   3  45  38  10   18   26   0  15
MF8   12  25  26  38  23  13  12   32   11  24   0</code></pre>
</div>
</div>
<p>Eliminar los pases menores a 10 para hacer mÃ¡s facil de interpretar el grÃ¡fico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>FIFAm[FIFAm <span class="sc">&lt;</span> <span class="dv">10</span> ] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>FIFAm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     GK1 DF3 DF4 DF5 MF6 FW7 FW9 MF10 FW11 DF2 MF8
GK1    0  42  67  21   0  27   0    0    0  17   0
DF3   30   0  44  14  42  15   0    0   10  36  29
DF4   38  43   0  57  18  11   0   21    0   0  28
DF5    0  14  47   0  11  50  20   40    0   0  42
MF6    0  28  25  10   0  41  28   37   14  34  21
FW7    0  12   0  21  21   0  15   33    0  25  18
FW9    0   0   0   0   0  12   0   31   16   0   0
MF10   0  11  11  22  43  29  20    0   28  13  21
FW11   0   0   0   0   0   0  11   15    0  21  12
DF2   29  38   0   0  45  38  10   18   26   0  15
MF8   12  25  26  38  23  13  12   32   11  24   0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chordDiagram</span>(FIFAm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ajuste de parÃ¡metros:</p>
<ul>
<li><p>Jugadores en la misma posiciÃ³n van a tener el mismo color.</p></li>
<li><p>Como la red es dirigida, los pases de salida comienzan mÃ¡s lejos del cÃ­rculo exterior, lo que facilita ver la diferencia entre los pases enviados y los pases recibidos.</p></li>
<li><p>Ordenar a los jugadores por su posiciÃ³n.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>grid.col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#AA3939"</span>,<span class="fu">rep</span>(<span class="st">"#AA6C39"</span>,<span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"#2D882D"</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">"#226666"</span>,<span class="dv">3</span>))</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chordDiagram</span>(FIFAm,<span class="at">directional =</span> <span class="cn">TRUE</span>, <span class="at">grid.col =</span> grid.col, <span class="at">order=</span><span class="fu">c</span>(<span class="st">"GK1"</span>,<span class="st">"DF2"</span>,<span class="st">"DF3"</span>,<span class="st">"DF4"</span>,<span class="st">"DF5"</span>, <span class="st">"MF6"</span>,<span class="st">"MF8"</span>,<span class="st">"MF10"</span>,<span class="st">"FW7"</span>, <span class="st">"FW9"</span>,<span class="st">"FW11"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Mapas de calor</strong></p>
<p>Los mapas de calor resaltan nodos con mayor cantidad de conexiones en redes ponderadas. Se debe crear una sociomatriz que refleje el peso y se debem definir los nombres de filas y columnas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(FIFA_Nether)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>FIFAm <span class="ot">&lt;-</span> <span class="fu">as.sociomatrix</span>(FIFA_Nether, <span class="at">attrname=</span><span class="st">'passes'</span>)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(FIFAm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GK1"</span>, <span class="st">"DF3"</span>, <span class="st">"DF4"</span>, <span class="st">"DF5"</span>, <span class="st">"MF6"</span>, <span class="st">"FW7"</span>, <span class="st">"FW9"</span>, <span class="st">"MF10"</span>, <span class="st">"FW11"</span>, <span class="st">"DF2"</span>, <span class="st">"MF8"</span>)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(FIFAm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GK1"</span>, <span class="st">"DF3"</span>, <span class="st">"DF4"</span>, <span class="st">"DF5"</span>, <span class="st">"MF6"</span>, <span class="st">"FW7"</span>, <span class="st">"FW9"</span>, <span class="st">"MF10"</span>, <span class="st">"FW11"</span>, <span class="st">"DF2"</span>, <span class="st">"MF8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#669999"</span>, <span class="st">"#003333"</span>))</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(FIFAm[,<span class="dv">11</span><span class="sc">:</span><span class="dv">1</span>], <span class="at">Rowv =</span> <span class="cn">NA</span>, <span class="at">Colv =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="fu">pal</span>(<span class="dv">60</span>), <span class="at">scale =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>CreaciÃ³n de diagramas con otros paquetes de R</strong></p>
<p><strong>Ggplot2</strong></p>
<p>Aunque ggplot2 no es un paquete completo de visualizaciÃ³n de redes, sus capacidades grÃ¡ficas avanzadas permiten crear grÃ¡ficos especializados de redes dirigidas, haciendo relaciones curvos entre cada dÃ­ada conectada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>edgeMaker <span class="ot">&lt;-</span> <span class="cf">function</span>(whichRow, <span class="at">len=</span><span class="dv">100</span>, <span class="at">curved =</span> <span class="cn">TRUE</span>){</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  fromC <span class="ot">&lt;-</span> layoutCoordinates[adjacencyList[whichRow, <span class="dv">1</span>],]</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  toC <span class="ot">&lt;-</span> layoutCoordinates[adjacencyList[whichRow, <span class="dv">2</span>], ]</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  graphCenter <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(layoutCoordinates)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  bezierMid <span class="ot">&lt;-</span> <span class="fu">c</span>(fromC[<span class="dv">1</span>], toC[<span class="dv">2</span>])</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  distance1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((graphCenter <span class="sc">-</span> bezierMid)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(distance1 <span class="sc">&lt;</span> <span class="fu">sum</span>((graphCenter <span class="sc">-</span> <span class="fu">c</span>(toC[<span class="dv">1</span>], fromC[<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)){</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>    bezierMid <span class="ot">&lt;-</span> <span class="fu">c</span>(toC[<span class="dv">1</span>], fromC[<span class="dv">2</span>])</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>  bezierMid <span class="ot">&lt;-</span> (fromC <span class="sc">+</span> toC <span class="sc">+</span> bezierMid) <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(curved <span class="sc">==</span> <span class="cn">FALSE</span>){bezierMid <span class="ot">&lt;-</span> (fromC <span class="sc">+</span> toC) <span class="sc">/</span> <span class="dv">2</span>}</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>  edge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Hmisc<span class="sc">::</span><span class="fu">bezier</span>(<span class="fu">c</span>(fromC[<span class="dv">1</span>], bezierMid[<span class="dv">1</span>], toC[<span class="dv">1</span>]),</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">c</span>(fromC[<span class="dv">2</span>], bezierMid[<span class="dv">2</span>], toC[<span class="dv">2</span>]),</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">evaluation =</span> len))</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>  edge<span class="sc">$</span>Sequence <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>len</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>  edge<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">paste</span>(adjacencyList[whichRow, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">collapse =</span> <span class="st">"-"</span>)</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(edge)</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>FunciÃ³n <em>bezier()</em> del paquete <em>Hmisc</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sna)</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggplot2)</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(Hmisc)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se deben transformar los datos a un formato de matriz de aristas y se eliminan pases menores a 10.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(FIFA_Nether)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>fifa <span class="ot">&lt;-</span> FIFA_Nether</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>fifa.edge <span class="ot">&lt;-</span> <span class="fu">as.edgelist.sna</span>(fifa, <span class="at">attrname=</span><span class="st">'passes'</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>fifa.edge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(fifa.edge)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(fifa.edge)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">'Value'</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>fifa.edge <span class="ot">&lt;-</span> fifa.edge[fifa.edge<span class="sc">$</span>Value <span class="sc">&gt;</span> <span class="dv">9</span>, ]</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>adjacencyList <span class="ot">&lt;-</span> fifa.edge</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se usa la funciÃ³n <em>gplot</em> para almacenar las coordenadas de diseÃ±o para la funciÃ³n ggplot2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>layoutCoordinates <span class="ot">&lt;-</span> <span class="fu">gplot</span>(<span class="fu">network</span>(fifa.edge))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>allEdges <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fifa.edge), edgeMaker, <span class="at">len =</span> <span class="dv">500</span>, <span class="at">curved =</span> <span class="cn">TRUE</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>allEdges <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, allEdges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>new_theme_empty <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>()</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>new_theme_empty<span class="sc">$</span>line <span class="ot">&lt;-</span> <span class="fu">element_blank</span>()</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>new_theme_empty<span class="sc">$</span>rect <span class="ot">&lt;-</span> <span class="fu">element_blank</span>()</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>new_theme_empty<span class="sc">$</span>strip.text <span class="ot">&lt;-</span> <span class="fu">element_blank</span>()</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>new_theme_empty<span class="sc">$</span>axis.text <span class="ot">&lt;-</span> <span class="fu">element_blank</span>()</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>new_theme_empty<span class="sc">$</span>plot.title <span class="ot">&lt;-</span> <span class="fu">element_blank</span>()</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>new_theme_empty<span class="sc">$</span>axis.title <span class="ot">&lt;-</span> <span class="fu">element_blank</span>()</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>new_theme_empty<span class="sc">$</span>plot.margin <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), </span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">unit =</span> <span class="st">"lines"</span>, <span class="at">valid.unit =</span> <span class="dv">3</span>L, <span class="at">class =</span> <span class="st">"unit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>FunciÃ³n <em>ggplot</em>.</p>
<p>La opciÃ³n <em>scale_colour_gradient</em> controla la intensidad del degradado y la opciÃ³n <em>scale_size</em> controla la cantidad de conicidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>zpl <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(allEdges)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>zpl <span class="ot">&lt;-</span> zpl <span class="sc">+</span> <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">group =</span> Group, <span class="at">colour =</span> Sequence, <span class="at">size =</span> <span class="sc">-</span>Sequence))</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>zpl <span class="ot">&lt;-</span> zpl <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(layoutCoordinates), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"gray"</span>)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>zpl <span class="ot">&lt;-</span> zpl <span class="sc">+</span> <span class="fu">scale_colour_gradient</span>(<span class="at">low =</span> <span class="fu">gray</span>(<span class="dv">0</span>), <span class="at">high =</span> <span class="fu">gray</span>(<span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>), <span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>zpl <span class="ot">&lt;-</span> zpl <span class="sc">+</span> <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="fl">1.5</span>), <span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>zpl <span class="ot">&lt;-</span> zpl <span class="sc">+</span> new_theme_empty</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(zpl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="capÃ­tulo-8---subgrupos" class="level3">
<h3 class="anchored" data-anchor-id="capÃ­tulo-8---subgrupos">CapÃ­tulo 8 - Subgrupos</h3>
<p>Muchas redes sociales del mundo real pueden dividirse en subgrupos de redes densamente conectadas a travÃ©s de una menor cantidad de aristas, lo que va a ser de gran importancia identificar si se quiere de descubrir el comportamiento de toda la red.</p>
<p><strong>CohesiÃ³n social:</strong> La cohesiÃ³n social permite identificar subgrupos de individuos con enlaces fuertes y directos.</p>
<p><strong>Cliques:</strong> Un clique es un subgrafo maximamente completo, es decir un subgrafo donde cada vÃ©rtice puede acceder a los demÃ¡s a travÃ©s de una relaciÃ³n directa.</p>
<p><em>Ejemplo 1.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>clqexmp <span class="ot">&lt;-</span> <span class="fu">graph_from_literal</span>(A<span class="sc">:</span>B<span class="sc">:</span>C<span class="sc">:</span>D<span class="sc">--</span>A<span class="sc">:</span>B<span class="sc">:</span>C<span class="sc">:</span>D,D<span class="sc">-</span>E,E<span class="sc">-</span>F<span class="sc">-</span>G<span class="sc">-</span>E)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clqexmp, <span class="at">vertex.color =</span> <span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Este grafo tiene dos cliques, A, B, C, D y E, F, G. Los cliques relevantes van a ser los de orden igual o superior a 3. Por definiciÃ³n, un clique de orden <span class="math inline">\(k\)</span> tambiÃ©n contiene cliques de orden <span class="math inline">\(k-1\)</span>, <span class="math inline">\(k-2\)</span>, etc.</p>
<p>La funciÃ³n <em>clique_num()</em> muestra el orden del clique mÃ¡s grande.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clique_num</span>(clqexmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>La funciÃ³n <em>cliques()</em> retorna una lista de los cliques de un orden mÃ­nimo y mÃ¡ximo asignado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cliques</span>(clqexmp,<span class="at">min=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
+ 3/7 vertices, named, from 4e6f730:
[1] B C D

[[2]]
+ 3/7 vertices, named, from 4e6f730:
[1] E F G

[[3]]
+ 3/7 vertices, named, from 4e6f730:
[1] A B C

[[4]]
+ 4/7 vertices, named, from 4e6f730:
[1] A B C D

[[5]]
+ 3/7 vertices, named, from 4e6f730:
[1] A B D

[[6]]
+ 3/7 vertices, named, from 4e6f730:
[1] A C D</code></pre>
</div>
</div>
<p>La funciÃ³n <em>max_cliques()</em> es Ãºtil cuando hay muchos cliques, pues omite los cliques que hacen parte de cliques de orden mayor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max_cliques</span>(clqexmp,<span class="at">min=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
+ 3/7 vertices, named, from 4e6f730:
[1] E F G

[[2]]
+ 4/7 vertices, named, from 4e6f730:
[1] A B D C</code></pre>
</div>
</div>
<p>La funciÃ³n <em>largest_cliques()</em> identifica el clique de orden mayor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">largest_cliques</span>(clqexmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
+ 4/7 vertices, named, from 4e6f730:
[1] A B D C</code></pre>
</div>
</div>
<p>La siguiente linea de cÃ³digo muestra como se puede obtener el nombre de los vÃ©rtices, en lugar de sus idâs (como lo hacen las funciones anteriores).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(clqexmp)[<span class="fu">unlist</span>(<span class="fu">largest_cliques</span>(clqexmp))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 4/7 vertices, named, from 4e6f730:
[1] A B D C</code></pre>
</div>
</div>
<p><em>Desventajas de los cliques:</em></p>
<ul>
<li><p>Es una definiciÃ³n conservadora de un subgrupo cohesivo, pues requiere que cada vertice este relacionado con todos los demÃ¡s, lo que podrÃ­a descartar subgrupos realmente cohesivos por falta de unos pocos enlaces.</p></li>
<li><p>Dada su anterior limitaciÃ³n, en redes grandes del mundo real, los cliques no son comunes.</p></li>
</ul>
<p>La siguiente simulaciÃ³n muestra lo poco comunes que son los cliques. Se simularon 4 redes con 25, 50, 100 y 500 nodos. Para cada red, el promedio del grado es como mÃ¡ximo 6. La tabla muestra que el nÃºmero de cliques se mantiene constante a pesar de que el orden de la red aumenta. AdemÃ¡s, los cliques son de tamaÃ±o pequeÃ±o en todos los casos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9679</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>g25 <span class="ot">&lt;-</span> <span class="fu">erdos.renyi.game</span>(<span class="dv">25</span>, <span class="dv">75</span>, <span class="at">type=</span><span class="st">"gnm"</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>g50 <span class="ot">&lt;-</span> <span class="fu">erdos.renyi.game</span>(<span class="dv">50</span>, <span class="dv">150</span>, <span class="at">type=</span><span class="st">"gnm"</span>)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>g100 <span class="ot">&lt;-</span> <span class="fu">erdos.renyi.game</span>(<span class="dv">100</span>, <span class="dv">300</span>, <span class="at">type=</span><span class="st">"gnm"</span>)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>g500 <span class="ot">&lt;-</span> <span class="fu">erdos.renyi.game</span>(<span class="dv">500</span>, <span class="dv">1500</span>, <span class="at">type=</span><span class="st">"gnm"</span>)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>lrgclq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">clique_num</span>(g25),<span class="fu">clique_num</span>(g50), <span class="fu">clique_num</span>(g100),<span class="fu">clique_num</span>(g500))</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>numclq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">length</span>(<span class="fu">cliques</span>(g25,<span class="at">min=</span><span class="dv">3</span>)),<span class="fu">length</span>(<span class="fu">cliques</span>(g50,<span class="at">min=</span><span class="dv">3</span>)),</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">length</span>(<span class="fu">cliques</span> (g100,<span class="at">min=</span><span class="dv">3</span>)),<span class="fu">length</span>(<span class="fu">cliques</span>(g500,<span class="at">min=</span><span class="dv">3</span>)))</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>clqinfo <span class="ot">&lt;-</span> <span class="fu">data.frame</span> (<span class="at">Nodes=</span>nodes,<span class="at">Largest=</span>lrgclq,</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="at">Number=</span>numclq)</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a>clqinfo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Nodes Largest Number
1    25       4     34
2    50       3     36
3   100       3     36
4   500       3     38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(clqinfo, align = "c")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>k-cores</strong></p>
<p>Es una variaciÃ³n de la idea de los cliques. Un k-core es un subgrafo maximal donde cada vertice estÃ¡ conectado con al menos k vertices. Una de las ventajas del k-core es que es anidado, es decir cada miembro de un 4-core es miembro de un 3-core y asÃ­ sucesivamente.</p>
<p><em>Ejemplo DHHS</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(statnet)</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("remotes")</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("DougLuke/UserNetR")</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(UserNetR)</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="co"># data(DHHS)</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="co"># library(intergraph)</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>iDHHS <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(DHHS)</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_density</span>(iDHHS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.312369</code></pre>
</div>
</div>
<p>La funciÃ³n <em>subgraph.edges()</em> selecciona solo las aristas con atributos 3 o 4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>iDHHS<span class="ot">&lt;-</span><span class="fu">subgraph_from_edges</span>(iDHHS,<span class="fu">E</span>(iDHHS)[collab<span class="sc">&gt;</span><span class="dv">2</span>])</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_density</span>(iDHHS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1533688</code></pre>
</div>
</div>
<p>La funciÃ³n <em>graph.coreness()</em> identifica la estructura k-core</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>coreness<span class="ot">&lt;-</span><span class="fu">coreness</span>(iDHHS)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(coreness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>coreness
 1  2  3  4  5  6 
 7  6  2  5  2 26 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>maxCoreness<span class="ot">&lt;-</span><span class="fu">max</span>(coreness)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>maxCoreness</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>Grafica de la red teniendo en cuenta la estrcutura k-core</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vname &lt;- get.vertex.attribute(iDHHS, name= 'vertex.names',index=V(iDHHS))</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co"># V(iDHHS)$name&lt;-Vname</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(iDHHS)<span class="sc">$</span>color<span class="ot">&lt;-</span>coreness<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iDHHS,<span class="at">vertex.label.cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Agregar labels que indiquen el valor k-core</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span><span class="fu">rainbow</span>(maxCoreness)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iDHHS,<span class="at">vertex.label=</span>coreness,<span class="at">vertex.color=</span>colors[coreness])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El centro de la red estÃ¡ compuesta principalmente por los k-core mÃ¡s altos.</p>
<p>Para examinar los patrones de cada subgrupo, se van a ir despegando los k-cores del mÃ¡s bajo al mÃ¡s alto con la funciÃ³n <em>induced.subgraph()</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(iDHHS)<span class="sc">$</span>name <span class="ot">&lt;-</span> coreness</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(iDHHS)<span class="sc">$</span>color <span class="ot">&lt;-</span> colors[coreness]</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>iDHHS1_6 <span class="ot">&lt;-</span> iDHHS</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>iDHHS2_6 <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(iDHHS, <span class="at">vids=</span> <span class="fu">which</span>(coreness <span class="sc">&gt;</span> <span class="dv">1</span>))</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>iDHHS3_6 <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(iDHHS,<span class="at">vids =</span> <span class="fu">which</span>(coreness <span class="sc">&gt;</span> <span class="dv">2</span>))</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>iDHHS4_6 <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(iDHHS,<span class="at">vids =</span> <span class="fu">which</span>(coreness <span class="sc">&gt;</span> <span class="dv">3</span>))</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>iDHHS5_6 <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(iDHHS,<span class="at">vids =</span> <span class="fu">which</span>(coreness <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>iDHHS6_6 <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(iDHHS,<span class="at">vids =</span> <span class="fu">which</span>(coreness <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>lay <span class="ot">&lt;-</span> <span class="fu">layout.fruchterman.reingold</span>(iDHHS)</span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span> (<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>),<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (iDHHS1_6,<span class="at">layout=</span>lay,<span class="at">main=</span><span class="st">"All k-cores"</span>)</span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (iDHHS2_6,<span class="at">layout=</span>lay[<span class="fu">which</span>(coreness <span class="sc">&gt;</span> <span class="dv">1</span>),],<span class="at">main=</span><span class="st">"k-cores 2-6"</span>)</span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (iDHHS3_6,<span class="at">layout=</span>lay[<span class="fu">which</span> (coreness <span class="sc">&gt;</span> <span class="dv">2</span>),],<span class="at">main=</span><span class="st">"k-cores 3-6"</span>)</span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (iDHHS4_6,<span class="at">layout=</span>lay [<span class="fu">which</span> (coreness <span class="sc">&gt;</span> <span class="dv">3</span>),],<span class="at">main=</span><span class="st">"k-cores 4-6"</span>)</span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (iDHHS5_6,<span class="at">layout=</span>lay[<span class="fu">which</span> (coreness <span class="sc">&gt;</span> <span class="dv">4</span>),],<span class="at">main=</span><span class="st">"k-cores 5-6"</span>)</span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (iDHHS6_6,<span class="at">layout=</span>lay[<span class="fu">which</span>(coreness <span class="sc">&gt;</span> <span class="dv">5</span>),],<span class="at">main=</span><span class="st">"k-cores 6-6"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>DetecciÃ³n comunitaria</strong></p>
<p>Tanto k-cores como cliques son ejemplos que para identificar subgrupos dependen del patron de relaciones internas definidas en estos. Sin embargo, existen algoritmos de identificaciÃ³n de subgrupos que detectan grupos de tal manera que hayan muchas relaciones internas y algunas entre otros grupos.</p>
<p><strong>Modularidad</strong></p>
<p>Es una medida del grado en que los nodos presentan agrupamiento, donde hay mayor densidad dentro de los grupos y menos densidad entre ellos.</p>
<ul>
<li><p>Puede ser usada para que un algoritmo intente maximizarla y devuelva la mejor clasificaciÃ³n que explique a la red.</p></li>
<li><p>Puede ser usada como estadÃ­stica para cualquier variable de clasificaciÃ³n de nodos.</p></li>
</ul>
<p>La modularidad puede variar desde <span class="math inline">\(\frac{-1}{2}\)</span> a <span class="math inline">\(1\)</span>. Entre mÃ¡s cerca de 1, mÃ¡s agrupaciÃ³n exhibe la red con respecto a la variable de agrupamiento dada.</p>
<p><em>Ejemplo</em>: Red de 9 nodos con dos atributos que clasifican los nodos en tres grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">graph_from_literal</span>(A<span class="sc">-</span>B<span class="sc">-</span>C<span class="sc">-</span>A,D<span class="sc">-</span>E<span class="sc">-</span>F<span class="sc">-</span>D,G<span class="sc">-</span>H<span class="sc">-</span>I<span class="sc">-</span>G,A<span class="sc">-</span>D<span class="sc">-</span>G<span class="sc">-</span>A)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g1)<span class="sc">$</span>grp_good <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g1)<span class="sc">$</span>grp_bad <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g1,<span class="at">vertex.color =</span>(<span class="fu">V</span>(g1)<span class="sc">$</span>grp_good),<span class="at">vertex.size=</span><span class="dv">20</span>,  <span class="at">main=</span><span class="st">"Good Grouping"</span>)</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g1,<span class="at">vertex.color=</span>(<span class="fu">V</span>(g1)<span class="sc">$</span>grp_bad),<span class="at">vertex.size=</span><span class="dv">20</span>,<span class="at">main=</span><span class="st">"Bad Grouping"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La agrupaciÃ³n que mejor explica a la red es la de la izquierda, lo que se puede comprobar calculando la modularidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(g1,<span class="fu">V</span>(g1)<span class="sc">$</span>grp_good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4166667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(g1,<span class="fu">V</span>(g1)<span class="sc">$</span>grp_bad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3333333</code></pre>
</div>
</div>
<p><em>Ejemplo DHHS</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(DHHS)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>iDHHS <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(DHHS)</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">V</span>(iDHHS)<span class="sc">$</span>agency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 0  1  2  3  4  5  6  7  8  9 10 
 2  4 12  2  2  3  2 16  3  5  3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(iDHHS)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ 10/54 vertices, from 519d8a0:
 [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(iDHHS,(<span class="fu">V</span>(iDHHS)<span class="sc">$</span>agency<span class="sc">+</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1402264</code></pre>
</div>
</div>
<p>Como la modularidad es de 0.14, entonces la variable <em>agency</em> explica algo del agrupamiento presente en la red.</p>
<p>La modularidad adquiere un significado mÃ¡s Ãºtil si se utiliza para compararse con otra medida relevante. Por ejemplo, comparar la estadÃ­stica usando dos variables nodales distintas.</p>
<p><em>Ejemplo Moreno</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Moreno)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>iMoreno <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(Moreno)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">V</span>(iMoreno)<span class="sc">$</span>gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2 
16 17 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(iMoreno,<span class="fu">V</span>(iMoreno)<span class="sc">$</span>gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4761342</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Facebook)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>Facebook <span class="ot">&lt;-</span> <span class="fu">upgrade_graph</span>(Facebook)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">factor</span>(<span class="fu">V</span>(Facebook)<span class="sc">$</span>group))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "B" "C" "F" "G" "H" "M" "S" "W"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>grp_num <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(<span class="fu">V</span>(Facebook)<span class="sc">$</span>group))</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(Facebook,grp_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6145798</code></pre>
</div>
</div>
<p><strong>Algoritmos de detecciÃ³n de comunidades</strong></p>
<p>Correr una de las funciones de <em>igraph()</em> que contiene un algoritmo para detecciÃ³n de comunidades:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>cw <span class="ot">&lt;-</span> <span class="fu">cluster_walktrap</span>(iMoreno)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(cw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 3 3 3 5 5 5 5 1 3 2 2 2 4 4 4 2 2 2 2 2 2 2 2 6 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(cw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6181474</code></pre>
</div>
</div>
<p>Se identificaron 6 grupos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cw, iMoreno)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se puede comparar esta particiÃ³n generada con alguna particiÃ³n existente basada en una variable nodal.</p>
<p><em>Ejemplo DHHS</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>cw <span class="ot">&lt;-</span> <span class="fu">cluster_walktrap</span>(iDHHS)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(cw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1653754</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(cw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 4 5 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3
[39] 3 3 3 3 3 2 2 2 2 1 2 1 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">V</span>(iDHHS)<span class="sc">$</span>agency,<span class="fu">membership</span>(cw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    
      1  2  3  4  5
  0   0  0  0  1  1
  1   4  0  0  0  0
  2  12  0  0  0  0
  3   2  0  0  0  0
  4   2  0  0  0  0
  5   3  0  0  0  0
  6   2  0  0  0  0
  7   0  0 16  0  0
  8   0  3  0  0  0
  9   3  2  0  0  0
  10  3  0  0  0  0</code></pre>
</div>
</div>
<p>Se pueden comparar distintas particiones generadas por algoritmos distintos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Bali)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>iBali <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(Bali)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>cw <span class="ot">&lt;-</span> <span class="fu">cluster_walktrap</span>(iBali)</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(cw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2830688</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(cw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2 1 2 1 2 2 1 2 2 3 3 3 3 3 2 2 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>ceb <span class="ot">&lt;-</span> <span class="fu">cluster_edge_betweenness</span>(iBali)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(ceb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2387251</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(ceb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 2 2 2 2 2 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">cluster_spinglass</span>(iBali)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(cs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2966742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(cs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3 2 3 1 3 3 2 3 3 1 1 1 1 1 3 3 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">&lt;-</span> <span class="fu">cluster_fast_greedy</span>(iBali)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(cfg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2629126</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(cfg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2 2 1 2 1 2 2 1 1 3 3 3 3 3 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>clp <span class="ot">&lt;-</span> <span class="fu">cluster_label_prop</span>(iBali)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(clp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2387251</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(clp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 2 2 2 2 2 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>cle <span class="ot">&lt;-</span> <span class="fu">cluster_leading_eigen</span>(iBali)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(cle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2750063</code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(cle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 2 1 1 2 1 1 2 2 2 2 2 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(iBali)</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2966742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 2 1 3 1 1 2 1 1 3 3 3 3 3 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>co <span class="ot">&lt;-</span> <span class="fu">cluster_optimal</span>(iBali)</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modularity</span>(co)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2966742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(co)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 2 1 3 1 1 2 1 1 3 3 3 3 3 1 1 1</code></pre>
</div>
</div>
<p>Todos los algoritmos identificaron 2 o 3 grupos y el rango de la modularidad fue de 0.24 a 0.30.</p>
<p>Los resultados de la detecciÃ³n de los grupos se pueden comparar utilizando mÃ©tricas de comparaciÃ³n de clasificaciÃ³n, por ejemplo la estadÃ­stica Rand ajustada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">V</span>(iBali)<span class="sc">$</span>role,<span class="fu">membership</span>(cw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    
     1 2 3
  BM 0 5 0
  CT 1 2 0
  OA 2 1 0
  SB 0 1 1
  TL 0 0 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(<span class="fu">V</span>(iBali)<span class="sc">$</span>role)),cw,<span class="at">method=</span><span class="st">"adjusted.rand"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3504908</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(cw,ceb,<span class="at">method=</span><span class="st">"adjusted.rand"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6155779</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(cw,cs,<span class="at">method=</span><span class="st">"adjusted.rand"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8898148</code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(cw,cfg,<span class="at">method=</span><span class="st">"adjusted.rand"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6691802</code></pre>
</div>
</div>
<p>Graficos de resultados de la detecciÃ³n grupos con diferentes algoritmos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ceb, iBali,<span class="at">vertex.label=</span><span class="fu">V</span>(iBali)<span class="sc">$</span>role,<span class="at">main=</span><span class="st">"Edge Betweenness"</span>)</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cfg, iBali,<span class="at">vertex.label=</span><span class="fu">V</span>(iBali)<span class="sc">$</span>role,<span class="at">main=</span><span class="st">"Fastgreedy"</span>)</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clp, iBali,<span class="at">vertex.label=</span><span class="fu">V</span>(iBali)<span class="sc">$</span>role,<span class="at">main=</span><span class="st">"Label Propagation"</span>)</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cle, iBali,<span class="at">vertex.label=</span><span class="fu">V</span>(iBali)<span class="sc">$</span>role,<span class="at">main=</span><span class="st">"Leading Eigenvector"</span>)</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cs, iBali,<span class="at">vertex.label=</span><span class="fu">V</span>(iBali)<span class="sc">$</span>role,<span class="at">main=</span><span class="st">"Spinglass"</span>)</span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cw, iBali,<span class="at">vertex.label=</span><span class="fu">V</span>(iBali)<span class="sc">$</span>role,<span class="at">main=</span><span class="st">"Walktrap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="capÃ­tulo-9---redes-de-afiliaciÃ³n" class="level3">
<h3 class="anchored" data-anchor-id="capÃ­tulo-9---redes-de-afiliaciÃ³n">CapÃ­tulo 9 - Redes de afiliaciÃ³n</h3>
<p>Una red de afiliaciÃ³n es aquella donde los miembros estÃ¡n conectados por su co-pertenencia a un grupo o por su co-participaciÃ³n en algÃºn evento. Por ejemplo, estudiantes que pertenecen a la misma clase pueden considerarse conectados, aunque no sepamos si tienen vÃ­nculos sociales directos.</p>
<p><em>Ejemplo - estudiantes</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>C1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>C2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>C3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>C4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>aff.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(C1,C2,C3,C4)</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(aff.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S1"</span>,<span class="st">"S2"</span>,<span class="st">"S3"</span>,<span class="st">"S4"</span>,<span class="st">"S5"</span>,<span class="st">"S6"</span>)</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(aff.df, <span class="at">align =</span> <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">C1</th>
<th style="text-align: center;">C2</th>
<th style="text-align: center;">C3</th>
<th style="text-align: center;">C4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">S2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">S4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S5</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">S6</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Esta es una matriz de incidencia, que indica si un estudiante s pertenece a un grupo g. A diferencia de una matriz de adyacencia, la matriz de incidencia no es cuadrada.</p>
<p><strong>Grafos bipartitos</strong> En redes de afiliaciÃ³n hay dos tipos de nodos: actores (individuos) y grupos (a los que pertenecen los actores). Las relaciones solo conectan actores con grupos, pero no hay conexiones directas entre actores ni entre grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>bn <span class="ot">&lt;-</span><span class="fu">graph_from_biadjacency_matrix</span>(aff.df)</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>plt.x <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">6</span>),<span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>plt.y <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>lay <span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">cbind</span>(plt.x,plt.y))</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>shapes <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"circle"</span>,<span class="st">"square"</span>)</span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>)</span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bn,<span class="at">vertex.color=</span>colors[<span class="fu">V</span>(bn)<span class="sc">$</span>type<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape=</span>shapes[<span class="fu">V</span>(bn)<span class="sc">$</span>type<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size=</span><span class="dv">10</span>,<span class="at">vertex.label.degree=</span><span class="sc">-</span>pi<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.dist=</span><span class="fl">1.2</span>,<span class="at">vertex.label.cex=</span><span class="fl">0.9</span>,</span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">layout=</span>lay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conceptos bÃ¡sicos</strong></p>
<p><strong>CreaciÃ³n de redes de afiliaciÃ³n a partir de matrices de incidencia</strong></p>
<p>En igraph, los grafos bipartitos se crean a partir de matrices de incidencia y, en este caso, las filas se leen como actores y las columnas como grupos o eventos. AdemÃ¡s, se tienen dos atributos de vÃ©rtice: - Nombre del vÃ©rtice. - Tipo de nodo: type = FALSE para actores o type = TRUE para grupos o eventos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_biadjacency_matrix</span>(bn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   C1 C2 C3 C4
S1  1  0  0  0
S2  1  1  0  0
S3  1  1  1  0
S4  0  1  1  0
S5  0  0  1  1
S6  0  0  0  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(bn)<span class="sc">$</span>type</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(bn)<span class="sc">$</span>name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "S1" "S2" "S3" "S4" "S5" "S6" "C1" "C2" "C3" "C4"</code></pre>
</div>
</div>
<p><strong>CreaciÃ³n de redes de afiliaciÃ³n a partir de listas de relaciones</strong></p>
<p>Es comÃºn construir redes usando listas de relaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>el.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">"S1"</span>,<span class="st">"C1"</span>),</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S2"</span>,<span class="st">"C1"</span>),</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S2"</span>,<span class="st">"C2"</span>),</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S3"</span>,<span class="st">"C1"</span>),</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S3"</span>,<span class="st">"C2"</span>),</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S3"</span>,<span class="st">"C3"</span>),</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S4"</span>,<span class="st">"C2"</span>),</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S4"</span>,<span class="st">"C3"</span>),</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S5"</span>,<span class="st">"C3"</span>),</span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S5"</span>,<span class="st">"C4"</span>),</span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"S6"</span>,<span class="st">"C4"</span>)))</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a>bn2 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(el.df,<span class="at">directed=</span><span class="cn">FALSE</span>)</span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>bn2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH 55d96fb UN-- 10 11 -- 
+ attr: name (v/c)
+ edges from 55d96fb (vertex names):
 [1] S1--C1 S2--C1 S2--C2 S3--C1 S3--C2 S3--C3 S4--C2 S4--C3 S5--C3 S5--C4
[11] S6--C4</code></pre>
</div>
</div>
<p>Sin embargo, el objeto creado no se reconoce como bipartito. Para corregirlo, es necesario especificar manualmente el atributo <em>type</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(bn2)<span class="sc">$</span>type <span class="ot">&lt;-</span><span class="fu">V</span>(bn2)<span class="sc">$</span>name <span class="sc">%in%</span> el.df[,<span class="dv">1</span>]</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>bn2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH 55d96fb UN-B 10 11 -- 
+ attr: name (v/c), type (v/l)
+ edges from 55d96fb (vertex names):
 [1] S1--C1 S2--C1 S2--C2 S3--C1 S3--C2 S3--C3 S4--C2 S4--C3 S5--C3 S5--C4
[11] S6--C4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_density</span>(bn)<span class="sc">==</span><span class="fu">edge_density</span>(bn2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p><strong>VisualizaciÃ³n de redes de afiliaciÃ³n</strong></p>
<p>Para visualizar redes de afiliaciÃ³n es Ãºtil usar formas y colores que diferencien actores de grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>shapes <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"circle"</span>,<span class="st">"square"</span>)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>)</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bn,<span class="at">vertex.color=</span>colors[<span class="fu">V</span>(bn)<span class="sc">$</span>type<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape=</span>shapes[<span class="fu">V</span>(bn)<span class="sc">$</span>type<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size=</span><span class="dv">10</span>,<span class="at">vertex.label.degree=</span><span class="sc">-</span>pi<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.dist=</span><span class="fl">1.2</span>,<span class="at">vertex.label.cex=</span><span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Proyecciones</strong></p>
<p>En una red de afiliaciÃ³n, los nodos de cada grupo pueden estar conectados indirectamente a partir de las conexiones entre grupos. Por ejemplo: la clase C3 y C4 estÃ¡n conectadas a travÃ©s del estudiante S5.</p>
<p>Para analizar conexiones directas, se crean proyecciones que transforman la red en una estructura con un Ãºnico tipo de nodo, asÃ­, os actores se vinculan entre ellos cuando forman parte del mismo grupo y los grupos se enlazan entre sÃ­ cuando comparten actores en comÃºn.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>bn.pr <span class="ot">&lt;-</span> <span class="fu">bipartite_projection</span>(bn)</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>bn.pr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$proj1
IGRAPH 5651843 UNW- 6 8 -- 
+ attr: name (v/c), weight (e/n)
+ edges from 5651843 (vertex names):
[1] S1--S2 S1--S3 S2--S3 S2--S4 S3--S4 S3--S5 S4--S5 S5--S6

$proj2
IGRAPH 565187d UNW- 4 4 -- 
+ attr: name (v/c), weight (e/n)
+ edges from 565187d (vertex names):
[1] C1--C2 C1--C3 C2--C3 C3--C4</code></pre>
</div>
</div>
<p>Cada lista puede ser tratada como un objeto igraph cualquiera.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph.density</span>(bn.pr<span class="sc">$</span>proj1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `graph.density()` was deprecated in igraph 2.0.0.
â¹ Please use `edge_density()` instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>bn.student <span class="ot">&lt;-</span>bn.pr<span class="sc">$</span>proj1</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>bn.class <span class="ot">&lt;-</span>bn.pr<span class="sc">$</span>proj2</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="fu">graph.density</span>(bn.student)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5333333</code></pre>
</div>
</div>
<p>ObtenciÃ³n de las matrices de adyacencia con pesos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_adjacency_matrix</span>(bn.student,<span class="at">sparse=</span><span class="cn">FALSE</span>,<span class="at">attr=</span><span class="st">"weight"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   S1 S2 S3 S4 S5 S6
S1  0  1  1  0  0  0
S2  1  0  2  1  0  0
S3  1  2  0  2  1  0
S4  0  1  2  0  1  0
S5  0  0  1  1  0  1
S6  0  0  0  0  1  0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_adjacency_matrix</span>(bn.class,<span class="at">sparse=</span><span class="cn">FALSE</span>,<span class="at">attr=</span><span class="st">"weight"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   C1 C2 C3 C4
C1  0  2  1  0
C2  2  0  2  0
C3  1  2  0  1
C4  0  0  1  0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>shapes <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"circle"</span>,<span class="st">"square"</span>)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>)</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bn.student,<span class="at">vertex.color=</span><span class="st">"blue"</span>,</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape=</span><span class="st">"circle"</span>,<span class="at">main=</span><span class="st">"Students"</span>,</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width=</span><span class="fu">E</span>(bn.student)<span class="sc">$</span>weight<span class="sc">*</span><span class="dv">2</span>,</span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size=</span><span class="dv">15</span>,<span class="at">vertex.label.degree=</span><span class="sc">-</span>pi<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.dist=</span><span class="fl">1.2</span>,<span class="at">vertex.label.cex=</span><span class="dv">1</span>)</span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bn.class,<span class="at">vertex.color=</span><span class="st">"red"</span>,</span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape=</span><span class="st">"square"</span>,<span class="at">main=</span><span class="st">"Classes"</span>,</span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width=</span><span class="fu">E</span>(bn.student)<span class="sc">$</span>weight<span class="sc">*</span><span class="dv">2</span>,</span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size=</span><span class="dv">15</span>,<span class="at">vertex.label.degree=</span><span class="sc">-</span>pi<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb280-13"><a href="#cb280-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.dist=</span><span class="fl">1.2</span>,<span class="at">vertex.label.cex=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Ejemplo - actores de Hollywood</strong></p>
<p>El dataset hwd del paquete UseNetR contiene una red de afiliaciÃ³n de actores de Hollywood conectados a travÃ©s de pelÃ­culas. El conjunto de datos incluye a las diez pelÃ­culas mÃ¡s populares (segÃºn usuarios de IMDb) de cada aÃ±o desde 1999 hasta 2014, los diez primeros actores listados en IMDb para cada pelÃ­cula, los nombres de pelÃ­culas y actores y cada pelÃ­cula incluye el aÃ±o de lanzamiento, la calificaciÃ³n de usuarios de IMDb y la clasificaciÃ³n de pelÃ­culas segÃºn la MPAA.</p>
<p><strong>AnÃ¡lisis de la red</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hwd)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>h1 <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">upgrade_graph</span>(hwd)</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>h1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH 9cdab39 UN-B 1365 1600 -- 
+ attr: name (v/c), type (v/l), year (v/n), IMDBrating (v/n),
| MPAArating (v/c)
+ edges from 9cdab39 (vertex names):
 [1] Inception          --Leonardo DiCaprio   
 [2] Inception          --Joseph Gordon-Levitt
 [3] Inception          --Ellen Page          
 [4] Inception          --Tom Hardy           
 [5] Inception          --Ken Watanabe        
 [6] Inception          --Dileep Rao          
 [7] Inception          --Cillian Murphy      
+ ... omitted several edges</code></pre>
</div>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(h1)<span class="sc">$</span>name[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Inception"                                   
 [2] "Alice in Wonderland"                         
 [3] "Kick-Ass"                                    
 [4] "Toy Story 3"                                 
 [5] "How to Train Your Dragon"                    
 [6] "Despicable Me"                               
 [7] "Scott Pilgrim vs. the World"                 
 [8] "Hot Tub Time Machine"                        
 [9] "Harry Potter and the Deathly Hallows: Part 1"
[10] "Tangled"                                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(h1)<span class="sc">$</span>type[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(h1)<span class="sc">$</span>IMDBrating[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 8.8 6.5 7.8 8.4 8.2 7.7 7.5 6.5 7.7 7.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(h1)<span class="sc">$</span>name[<span class="dv">155</span><span class="sc">:</span><span class="dv">165</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Notting Hill"               "Eyes Wide Shut"            
 [3] "The Green Mile"             "10 Things I Hate About You"
 [5] "American Pie"               "Girl, Interrupted"         
 [7] "Leonardo DiCaprio"          "Joseph Gordon-Levitt"      
 [9] "Ellen Page"                 "Tom Hardy"                 
[11] "Ken Watanabe"              </code></pre>
</div>
</div>
<p>La descripciÃ³n del grafo h1 confirma que hwd es un grafo bipartito. Los enlaces conectan a cada actor con las pelÃ­culas en las que participÃ³. La red tiene 1,365 nodos y 1,600 vÃ­nculos, compuesta por 160 nodos de pelÃ­culas y 1,205 nodos de actores.</p>
<p>Con el paquete igraph, es posible almacenar informaciÃ³n de visualizaciÃ³n dentro del objeto de la red, como colores y formas de los nodos, configurÃ¡ndolos como atributos de los vÃ©rtices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(h1)<span class="sc">$</span>shape <span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">V</span>(h1)<span class="sc">$</span>type<span class="sc">==</span><span class="cn">TRUE</span>,</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"square"</span>,<span class="st">"circle"</span>)</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(h1)<span class="sc">$</span>shape[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "square" "square" "square" "square" "square" "square" "square" "square"
 [9] "square" "square"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(h1)<span class="sc">$</span>color <span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">V</span>(h1)<span class="sc">$</span>type<span class="sc">==</span><span class="cn">TRUE</span>,</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"red"</span>,<span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Extraer relaciones que son incidentes a ciertos nodos en particular:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>h2 <span class="ot">&lt;-</span> <span class="fu">subgraph_from_edges</span>(h1, <span class="fu">E</span>(h1)[<span class="fu">.inc</span>(<span class="fu">V</span>(h1)[name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"The Wolf of Wall Street"</span>, <span class="st">"Gangs of New York"</span>, <span class="st">"The Departed"</span>)])])</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h2, <span class="at">layout =</span> layout_with_kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>EstadÃ­sticas de la red</strong></p>
<p><em>Densidad de la red:</em> No es muy relevante, ya que todos los actores estÃ¡n conectados a al menos una pelÃ­cula y no existen conexiones directas entre actores o pelÃ­culas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph.density</span>(h1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001718711</code></pre>
</div>
</div>
<p><em>Grado</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(h1,<span class="at">v=</span><span class="fu">V</span>(h1)[type<span class="sc">==</span><span class="cn">FALSE</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4   5   6   7   8 
955 165  47  23  11   2   1   1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(h1,<span class="at">v=</span><span class="fu">V</span>(h1)[type<span class="sc">==</span><span class="cn">FALSE</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.327801</code></pre>
</div>
</div>
<p>La mayorÃ­a de actores solo apareciÃ³ en una pelÃ­cula, pero 15 actores participaron en cinco o mÃ¡s desde 1999. En promedio, cada actor apareciÃ³ en 1.3 pelÃ­culas.</p>
<p><em>Popularidad</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(h1)<span class="sc">$</span>deg <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(h1)</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(h1)[type<span class="sc">==</span><span class="cn">FALSE</span> <span class="sc">&amp;</span> deg <span class="sc">&gt;</span> <span class="dv">4</span>]<span class="sc">$</span>name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Leonardo DiCaprio" "Emma Watson"       "Richard Griffiths"
 [4] "Harry Melling"     "Daniel Radcliffe"  "Rupert Grint"     
 [7] "James Franco"      "Ian McKellen"      "Martin Freeman"   
[10] "Bradley Cooper"    "Christian Bale"    "Samuel L. Jackson"
[13] "Natalie Portman"   "Brad Pitt"         "Liam Neeson"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>busy_actor <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actor =</span> <span class="fu">V</span>(h1)[type<span class="sc">==</span><span class="cn">FALSE</span> <span class="sc">&amp;</span> deg <span class="sc">&gt;</span> <span class="dv">4</span>]<span class="sc">$</span>name,</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Movies =</span> <span class="fu">V</span>(h1)[type<span class="sc">==</span><span class="cn">FALSE</span> <span class="sc">&amp;</span> deg <span class="sc">&gt;</span> <span class="dv">4</span>]<span class="sc">$</span>deg</span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>busy_actor[<span class="fu">order</span>(busy_actor<span class="sc">$</span>Movies,<span class="at">decreasing=</span><span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Actor Movies
5   Daniel Radcliffe      8
11    Christian Bale      7
1  Leonardo DiCaprio      6
2        Emma Watson      6
3  Richard Griffiths      5
4      Harry Melling      5
6       Rupert Grint      5
7       James Franco      5
8       Ian McKellen      5
9     Martin Freeman      5
10    Bradley Cooper      5
12 Samuel L. Jackson      5
13   Natalie Portman      5
14         Brad Pitt      5
15       Liam Neeson      5</code></pre>
</div>
</div>
<p>Para medir la popularidad de los actores, se suma la calificaciÃ³n promedio de IMDb de las pelÃ­culas en las que actuaron.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">161</span><span class="sc">:</span><span class="dv">1365</span>) {</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">V</span>(h1)[i]<span class="sc">$</span>totrating <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">V</span>(h1)[<span class="fu">.nei</span>(i)]<span class="sc">$</span>IMDBrating)</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">V</span>(h1)<span class="sc">$</span>totrating,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>pop_actor <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actor =</span> <span class="fu">V</span>(h1)[type<span class="sc">==</span><span class="cn">FALSE</span> <span class="sc">&amp;</span> totrating <span class="sc">&gt;</span> <span class="dv">40</span>]<span class="sc">$</span>name,</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Popularity =</span> <span class="fu">V</span>(h1)[type<span class="sc">==</span><span class="cn">FALSE</span> <span class="sc">&amp;</span></span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>                       totrating <span class="sc">&gt;</span> <span class="dv">40</span>]<span class="sc">$</span>totrating))</span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>pop_actor[<span class="fu">order</span>(pop_actor<span class="sc">$</span>Popularity,<span class="at">decreasing=</span><span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Actor Popularity
3  Daniel Radcliffe       60.9
4    Christian Bale       55.5
1 Leonardo DiCaprio       49.6
2       Emma Watson         45
5         Brad Pitt       40.5</code></pre>
</div>
</div>
<p><em>RegresiÃ³n</em></p>
<p>Se examina si los actores mÃ¡s ocupados protagonizan pelÃ­culas mÃ¡s populares, a travÃ©s de la media de calificaciones de IMDb y un anÃ¡lisis de regresiÃ³n.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">161</span><span class="sc">:</span><span class="dv">1365</span>) {</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">V</span>(h1)[i]<span class="sc">$</span>avgrating <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">V</span>(h1)[<span class="fu">.nei</span>(i)]<span class="sc">$</span>IMDBrating)</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">V</span>(h1)[type<span class="sc">==</span><span class="cn">FALSE</span>]<span class="sc">$</span>deg</span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a>avgpop <span class="ot">&lt;-</span> <span class="fu">V</span>(h1)[type<span class="sc">==</span><span class="cn">FALSE</span>]<span class="sc">$</span>avgrating</span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(avgpop <span class="sc">~</span> num))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = avgpop ~ num)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.9858 -0.4330  0.1977  0.6170  1.6142 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.33868    0.05440 134.911   &lt;2e-16 ***
num          0.04714    0.03527   1.337    0.182    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9605 on 1203 degrees of freedom
Multiple R-squared:  0.001483,  Adjusted R-squared:  0.0006528 
F-statistic: 1.786 on 1 and 1203 DF,  p-value: 0.1816</code></pre>
</div>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter.smooth</span>(num,avgpop,<span class="at">col=</span><span class="st">"lightblue"</span>,</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>),<span class="at">span=</span>.<span class="dv">8</span>,</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab=</span><span class="st">"Number of Movies"</span>,</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab=</span><span class="st">"Avg. Popularity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-133-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El resultado muestra que no hay una relaciÃ³n clara entre el nÃºmero de pelÃ­culas y la popularidad.</p>
<p><strong>AnÃ¡lisis de proyecciones de actores y de pelÃ­culas</strong></p>
<p>Se crean las dos redes: - Red de actores: Los actores estÃ¡n conectados si actuaron juntos en una pelÃ­cula (1,205 nodos). - Red de pelÃ­culas: Las pelÃ­culas estÃ¡n conectadas si comparten actores (160 nodos).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>h1.pr <span class="ot">&lt;-</span><span class="fu">bipartite_projection</span>(h1)</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>h1.act <span class="ot">&lt;-</span>h1.pr<span class="sc">$</span>proj1</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>h1.mov <span class="ot">&lt;-</span>h1.pr<span class="sc">$</span>proj2</span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>h1.act</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH 61ec512 UNW- 1205 6903 -- 
+ attr: name (v/c), year (v/n), IMDBrating (v/n), MPAArating (v/c),
| shape (v/c), color (v/c), deg (v/n), totrating (v/n), avgrating
| (v/n), weight (e/n)
+ edges from 61ec512 (vertex names):
 [1] Leonardo DiCaprio--Joseph Gordon-Levitt
 [2] Leonardo DiCaprio--Ellen Page          
 [3] Leonardo DiCaprio--Tom Hardy           
 [4] Leonardo DiCaprio--Ken Watanabe        
 [5] Leonardo DiCaprio--Dileep Rao          
 [6] Leonardo DiCaprio--Cillian Murphy      
+ ... omitted several edges</code></pre>
</div>
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>h1.mov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH 61ec567 UNW- 160 472 -- 
+ attr: name (v/c), year (v/n), IMDBrating (v/n), MPAArating (v/c),
| shape (v/c), color (v/c), deg (v/n), totrating (v/n), avgrating
| (v/n), weight (e/n)
+ edges from 61ec567 (vertex names):
 [1] Inception--The Wolf of Wall Street    Inception--Django Unchained          
 [3] Inception--The Departed               Inception--Gangs of New York         
 [5] Inception--Catch Me If You Can        Inception--The Dark Knight Rises     
 [7] Inception--10 Things I Hate About You Inception--Batman Begins             
 [9] Inception--The Dark Knight            Inception--Training Day              
[11] Inception--Big Fish                  
+ ... omitted several edges</code></pre>
</div>
</div>
<p>En la red de pelÃ­culas, el tamaÃ±o de los nodos representa la popularidad de las pelÃ­culas segÃºn su calificaciÃ³n en IMDb.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1.mov,<span class="at">vertex.color=</span><span class="st">"red"</span>,</span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape=</span><span class="st">"circle"</span>,</span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size=</span>(<span class="fu">V</span>(h1.mov)<span class="sc">$</span>IMDBrating)<span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label=</span><span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-135-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(op)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Algunas estadÃ­sticas descriptivas de esta red son:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph.density</span>(h1.mov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03710692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count_components</span>(h1.mov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clusters</span>(h1.mov)<span class="sc">$</span>csize</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 148   1   1   1   1   1   1   2   1   1   1   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">E</span>(h1.mov)<span class="sc">$</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4   5   6   7  10 
411  21  12  16   6   1   2   3 </code></pre>
</div>
</div>
<p>La componente mÃ¡s grande de la red es:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>h2.mov <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(h1.mov, <span class="at">vids=</span><span class="fu">clusters</span>(h1.mov)<span class="sc">$</span>membership<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h2.mov,<span class="at">vertex.color=</span><span class="st">"red"</span>,</span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width=</span><span class="fu">sqrt</span>(<span class="fu">E</span>(h1.mov)<span class="sc">$</span>weight),</span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape=</span><span class="st">"circle"</span>,</span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size=</span>(<span class="fu">V</span>(h2.mov)<span class="sc">$</span>IMDBrating)<span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label=</span><span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-137-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">coreness</span>(h2.mov))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4  5  6  7 
11  5 23 65 29  7  8 </code></pre>
</div>
</div>
<p>Red con nodos mÃ¡s conectados, agregando labels a los nodos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>h3.mov <span class="ot">&lt;-</span><span class="fu">induced_subgraph</span>(h2.mov, <span class="at">vids=</span><span class="fu">coreness</span>(h2.mov)<span class="sc">&gt;</span><span class="dv">4</span>)</span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>h3.mov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH 639d0d8 UNW- 44 158 -- 
+ attr: name (v/c), year (v/n), IMDBrating (v/n), MPAArating (v/c),
| shape (v/c), color (v/c), deg (v/n), totrating (v/n), avgrating
| (v/n), weight (e/n)
+ edges from 639d0d8 (vertex names):
[1] Alice in Wonderland                      --Hot Tub Time Machine               
[2] Hot Tub Time Machine                     --The Interview                      
[3] The Hobbit: The Battle of the Five Armies--The Hobbit: The Desolation of Smaug
[4] Inception                                --The Wolf of Wall Street            
[5] Exodus: Gods and Kings                   --American Hustle                    
+ ... omitted several edges</code></pre>
</div>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h3.mov,<span class="at">vertex.color=</span><span class="st">"red"</span>,</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.shape=</span><span class="st">"circle"</span>,</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width=</span><span class="fu">sqrt</span>(<span class="fu">E</span>(h1.mov)<span class="sc">$</span>weight),</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex=</span><span class="fl">0.7</span>,<span class="at">vertex.label.color=</span><span class="st">"darkgreen"</span>,</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.dist=</span><span class="fl">0.3</span>,</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size=</span>(<span class="fu">V</span>(h3.mov)<span class="sc">$</span>IMDBrating)<span class="sc">-</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Taller2_files/figure-html/unnamed-chunk-138-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>